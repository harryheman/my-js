---
sidebar_position: 14
title: –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Docker
description: –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Docker
keywords: ['docker', 'docker compose', 'docker-compose', 'devops', 'container', 'guide', '—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ', '–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä']
tags: ['docker', 'docker compose', 'docker-compose', 'devops', 'container', 'guide', '—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ', '–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä']
---

# Docker

[–ü—Ä–∏–º–µ—Ä "–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ" React/Vue/Express/Postgres –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](https://github.com/harryheman/Blog-Posts/tree/master/docker-react-vue-express-postgres-app)&nbsp;&nbsp;üëÄ

## –í–≤–µ–¥–µ–Ω–∏–µ, Docker CLI –∏ Dockerfile

### –ß—Ç–æ —Ç–∞–∫–æ–µ Docker?

- [–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å `Docker` –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ](https://docs.docker.com/get-started/).
- [–ü–µ—Ä–µ–≤–æ–¥ —ç—Ç–æ–≥–æ "–Ω–∞—á–∞–ª–∞" –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ –æ—Ç Microsoft](https://docs.microsoft.com/ru-ru/visualstudio/docker/tutorials/docker-tutorial).

`Docker` - —ç—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–¥–µ–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å —Ç–µ–º, –∫–∞–∫ –º—ã —É–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏.

`Docker` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–ø–∞–∫–æ–≤—ã–≤–∞—Ç—å –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Å–ª–∞–±–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ. –ò–∑–æ–ª—è—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ (—Ö–æ—Å—Ç–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞—à–∞ –ª–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞, –¥–∞—Ç–∞ —Ü–µ–Ω—Ç—Ä, –æ–±–ª–∞—á–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∏–ª–∏ –∏—Ö –º–∏–∫—Å). –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —è–≤–ª—è—é—Ç—Å—è –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–º–∏ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —á—Ç–æ –∏–∑–±–∞–≤–ª—è–µ—Ç –Ω–∞—Å –æ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ —Ç–æ, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ —Ö–æ—Å—Ç–µ.

__–î–ª—è —á–µ–≥–æ `Docker` –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è?__

_–ë—ã—Å—Ç—Ä–∞—è –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π_

`Docker` —Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –ø–æ–∑–≤–æ–ª—è—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Å–µ—Ä–≤–∏—Å—ã. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ (continuous integration/continuous delivery, `CI/CD`).

_–û—Ç–∑—ã–≤—á–∏–≤–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ_

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö, –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –º–æ–≥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∏–ª–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞—Ö, –æ–±–ª–∞—á–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞—Ö –∏–ª–∏ —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö.

_–ó–∞–ø—É—Å–∫ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –æ–¥–Ω–æ–π –º–∞—à–∏–Ω–µ_

`Docker` —è–≤–ª—è–µ—Ç—Å—è –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–º –∏ –±—ã—Å—Ç—Ä—ã–º. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—É—é –∏ —ç–∫–æ–Ω–æ–º–∏—á–Ω—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º –º–∞—à–∏–Ω–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ [–≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–∞](https://ru.wikipedia.org/wiki/%D0%93%D0%B8%D0%BF%D0%B5%D1%80%D0%B2%D0%B8%D0%B7%D0%BE%D1%80), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ—â–Ω–æ—Å—Ç–µ–π –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Docker

`Docker` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É. –ö–ª–∏–µ–Ω—Ç (`Docker client`) –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –¥–µ–º–æ–Ω—É (`Docker daemon`), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–Ω–∏–º–∞–µ—Ç (—Å–æ–±–∏—Ä–∞–µ—Ç), –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã. –ö–ª–∏–µ–Ω—Ç –∏ –¥–µ–º–æ–Ω –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã –≤ –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É –¥–µ–º–æ–Ω—É. –ö–ª–∏–µ–Ω—Ç –∏ –¥–µ–º–æ–Ω –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `REST API` –ø–æ–≤–µ—Ä—Ö `UNIX-—Å–æ–∫–µ—Ç–æ–≤` –∏–ª–∏ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –î—Ä—É–≥–∏–º –∫–ª–∏–µ–Ω—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è `Docker Compose`, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏, —Å–æ—Å—Ç–æ—è—â–∏–º–∏ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

<img src="https://habrastorage.org/webt/dr/x3/4f/drx34fhmu1wqwpccdjzxgqufjeg.png" alt="" />
<br />

__–î–µ–º–æ–Ω__

–î–µ–º–æ–Ω (`dockerd`) —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç (—Å–ª—É—à–∞–µ—Ç) –∑–∞–ø—Ä–æ—Å—ã, –ø–æ—Å—Ç—É–ø–∞—é—â–∏–µ –æ—Ç `Docker API`, –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–∞–∫–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –∫–∞–∫ –æ–±—Ä–∞–∑—ã, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Å–µ—Ç–∏ –∏ —Ç–æ–º–∞. –î–µ–º–æ–Ω –º–æ–∂–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Å –¥—Ä—É–≥–∏–º–∏ –¥–µ–º–æ–Ω–∞–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏.

__–ö–ª–∏–µ–Ω—Ç__

–ö–ª–∏–µ–Ω—Ç (`docker`) - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å `Docker`. –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç–∞–∫–æ–π –∫–æ–º–∞–Ω–¥—ã, –∫–∞–∫ `docker run`, –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –¥–µ–º–æ–Ω—É, –∫–æ—Ç–æ—Ä—ã–π, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç. –ö–æ–º–∞–Ω–¥–∞ `docker` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Docker API`. –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –¥–µ–º–æ–Ω–∞–º–∏.

__`Docker Desktop`__

[`Docker Desktop`](https://docs.docker.com/desktop/) - —ç—Ç–æ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è `Mac` –∏ `Windows`, –ø–æ–∑–≤–æ–ª—è—é—â–µ–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã. `Docker Desktop` –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –¥–µ–º–æ–Ω–∞, –∫–ª–∏–µ–Ω—Ç–∞, `Docker Compose`, `Docker Content Trust`, `Kubernetes` –∏ `Credential Helper`.

__–†–µ–µ—Å—Ç—Ä__

–í —Ä–µ–µ—Å—Ç—Ä–µ (registry) —Ö—Ä–∞–Ω—è—Ç—Å—è –æ–±—Ä–∞–∑—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. [`Docker Hub`](https://hub.docker.com/) - —ç—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Docker` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤. –ò–º–µ–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Å—Ç–Ω—ã—Ö (–∑–∞–∫—Ä—ã—Ç—ã—Ö) —Ä–µ–µ—Å—Ç—Ä–æ–≤.

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç–∞–∫–∏—Ö –∫–æ–º–∞–Ω–¥, –∫–∞–∫ `docker pull` –∏–ª–∏ `docker run`, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –æ–±—Ä–∞–∑—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Ä–µ–µ—Å—Ç—Ä–∞. –ê –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `docker push` –æ–±—Ä–∞–∑ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Ä–µ–µ—Å—Ç—Ä.

__–û–±—ä–µ–∫—Ç—ã__

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `Docker` –º—ã —Å–æ–∑–¥–∞–µ–º –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—Ä–∞–∑—ã, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Å–µ—Ç–∏, —Ç–æ–º–∞, –ø–ª–∞–≥–∏–Ω—ã –∏ –¥—Ä—É–≥–∏–µ –æ–±—ä–µ–∫—Ç—ã. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö.

_–û–±—Ä–∞–∑—ã (`Images`)_

–û–±—Ä–∞–∑ - —ç—Ç–æ –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è —à–∞–±–ª–æ–Ω —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –ß–∞—Å—Ç–æ –æ–±—Ä–∞–∑ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é –¥—Ä—É–≥–æ–≥–æ –æ–±—Ä–∞–∑–∞.

–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –æ–±—Ä–∞–∑—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–∑—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–∏–º–∏ –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –≤ —Ä–µ–µ—Å—Ç—Ä–µ. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞–∑–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Dockerfile`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –æ–±—Ä–∞–∑–∞ –∏ –µ–≥–æ –∑–∞–ø—É—Å–∫—É (—Å–º. –Ω–∏–∂–µ). –†—è–¥ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –≤ `Dockerfile` –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–æ–∑–¥–∞–Ω–∏—é –≤ –æ–±—Ä–∞–∑–µ –Ω–æ–≤–æ–≥–æ —Å–ª–æ—è (—Ä–∞–Ω—å—à–µ –Ω–æ–≤—ã–π —Å–ª–æ–π —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏). –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `Dockerfile` –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π —Å–±–æ—Ä–∫–µ –æ–±—Ä–∞–∑–∞ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–±—Ä–∞–∑—ã –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–º–∏, –º–∞–ª–µ–Ω—å–∫–∏–º–∏ –∏ –±—ã—Å—Ç—Ä—ã–º–∏.

_–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (`Containers`)_

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä - —ç—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ–º—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –æ–±—Ä–∞–∑–∞. –ú—ã —Å–æ–∑–¥–∞–µ–º, –∑–∞–ø—É—Å–∫–∞–µ–º, –ø–µ—Ä–µ–º–µ—â–∞–µ–º –∏ —É–¥–∞–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –ø–æ–º–æ—â—å—é `Docker API` –∏–ª–∏ `CLI` (command line interface, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏). –ú—ã –º–æ–∂–µ–º –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∫ —Å–µ—Ç—è–º, –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –Ω–∏—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –¥–∞–∂–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ö–æ—Ä–æ—à–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –æ—Ç –¥—Ä—É–≥–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ —Ö–æ—Å—Ç–∞. –û–¥–Ω–∞–∫–æ –º—ã –º–æ–∂–µ–º —É–ø—Ä–∞–≤–ª—è—Ç—å —Ç–µ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã —Å–µ—Ç—å, —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –¥—Ä—É–≥–∞—è –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –æ–±—Ä–∞–∑–æ–º –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏ –µ–≥–æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏ –∑–∞–ø—É—Å–∫–µ. –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–∞–∫–∂–µ —É–¥–∞–ª—è–µ—Ç—Å—è. –≠—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö.

_–ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã `docker run`_

–°–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `ubuntu`, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Å–µ–∞–Ω—Å—É –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤ –Ω–µ–π –∫–æ–º–∞–Ω–¥—É `/bin/bash`:

```bash
docker run -i -t ubuntu /bin/bash
```

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

1. –ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞ –Ω–∞—à–µ–π –º–∞—à–∏–Ω–µ –Ω–µ—Ç –æ–±—Ä–∞–∑–∞ `ubuntu`, `Docker` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –µ–≥–æ –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞ (—Ç–æ –∂–µ —Å–∞–º–æ–µ –¥–µ–ª–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞ `docker pull ubuntu`).
2. `Docker` —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (—Ç–æ –∂–µ —Å–∞–º–æ–µ –¥–µ–ª–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞ `docker container create`).
3. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ª–æ—è `Docker` –≤—ã–¥–µ–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –µ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.
4. –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –Ω–µ —É–∫–∞–∑–∞–ª–∏ —Å–µ—Ç–µ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫, `Docker` —Å–æ–∑–¥–∞–µ—Ç —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π —Å–µ—Ç–∏. –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É [`IP-–∞–¥—Ä–µ—Å–∞`](https://ru.wikipedia.org/wiki/IP-%D0%B0%D0%B4%D1%80%D0%B5%D1%81). –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –≤–Ω–µ—à–Ω–∏–º —Å–µ—Ç—è–º —á–µ—Ä–µ–∑ —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ö–æ—Å—Ç–∞.
5. `Docker` –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç `/bin/bash`. –ü–æ—Å–∫–æ–ª—å–∫—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—É (–±–ª–∞–≥–æ–¥–∞—Ä—è —Ñ–ª–∞–≥–∞–º `-i` –∏ `-t`), –º—ã –º–æ–∂–µ–º –≤–≤–æ–¥–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –∏ –ø–æ–ª—É—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.
6. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã `exit` –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `/bin/bash`. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è. –ú—ã –º–æ–∂–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ —Å–Ω–æ–≤–∞ –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å.

### –ö–æ–º–∞–Ω–¥—ã –∏ —Ñ–ª–∞–≥–∏

__`docker run`__

–ö–æ–º–∞–Ω–¥–∞ `docker run` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –∏ –ø–æ—Ç–æ–º—É –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –∫–æ–º–∞–Ω–¥–∞.

```bash
# —Å–∏–≥–Ω–∞—Ç—É—Ä–∞
docker run [OPTIONS] IMAGE[:TAG|@DIGEST] [COMMAND] [ARG...]
# –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Ñ–ª–∞–≥–∏)
-d - –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
-p - –ø—É–±–ª–∏–∫–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –ø–æ—Ä—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —Ö–æ—Å—Ç–∞ (HOST:CONTAINER)
# –Ω–∞–ø—Ä–∏–º–µ—Ä
-p 3000:3000
-t - –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø—Å–µ–≤–¥–æ—Ç–µ—Ä–º–∏–Ω–∞–ª–∞
-i - –æ—Å—Ç–∞–≤–∏—Ç—å STDIN –æ—Ç–∫—Ä—ã—Ç—ã–º –±–µ–∑ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—É
--name - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
--rm - –æ—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ/—É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
--restart - –ø–æ–ª–∏—Ç–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ - no (default) | on-failure[:max-retries] | always | unless-stopped
-e - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è
-v - –ø—Ä–∏–≤—è–∑–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã (name:/path/to/file)
# –Ω–∞–ø—Ä–∏–º–µ—Ä
-v mydb:/etc/mydb
-w - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
```

–°–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `postgres`:

```bash
# \ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–ª–∏–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫
docker run --rm \
 # –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
 --name postgres \
 # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
 -e POSTGRES_USER=postgres \
 # –ø–∞—Ä–æ–ª—å
 -e POSTGRES_PASSWORD=postgres \
 # –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
 -e POSTGRES_DB=mydb \
 # –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ä–µ–∂–∏–º –∏ –ø–æ—Ä—Ç
 -dp 5432:5432 \
 # —Ç–æ–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
 -v $HOME/docker/volumes/postgres:/var/lib/postgresql/data \
 # –æ–±—Ä–∞–∑
 postgres
```

__`docker build`__

–ö–æ–º–∞–Ω–¥–∞ `docker build` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞–∑–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–π–ª–∞ `Dockerfile` –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –ö–æ–Ω—Ç–µ–∫—Å—Ç - —ç—Ç–æ –Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –ª–æ–∫–∞—Ü–∏–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å –ø–æ–º–æ—â—å—é `PATH` –∏–ª–∏ `URL`. `PATH` - —ç—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≤ –Ω–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ, –∞ `URL` - —ç—Ç–æ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ, –ø–æ—ç—Ç–æ–º—É `PATH` –≤–∫–ª—é—á–∞–µ—Ç –∫–∞–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, —Ç–∞–º –∏ –≤—Å–µ –µ–µ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∞ `URL` - –∫–∞–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, —Ç–∞–∫ –∏ –≤—Å–µ –µ–≥–æ —Å—É–±–º–æ–¥—É–ª–∏. –î–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏–∑ —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [`.dockerignore`](https://docs.docker.com/engine/reference/builder/#dockerignore-file) (—Å–∏–Ω—Ç–∞–∫—Å–∏—Å —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –ø–æ—Ö–æ–∂ –Ω–∞ `.gitignore`).

```bash
# —Å–∏–≥–Ω–∞—Ç—É—Ä–∞
docker build [OPTIONS] PATH | URL | -
```

–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞:

```bash
# –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
docker build .
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ `Dockerfile` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è):

```bash
docker build github.com/creack/docker-firefox
```

```bash
docker build -f ctx/Dockerfile http://server/ctx.tar.gz
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `http://server/ctx.tar.gz` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –¥–µ–º–æ–Ω—É, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ñ–∞–π–ª—ã. –ü–∞—Ä–∞–º–µ—Ç—Ä `-f ctx/Dockerfile` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—É—Ç—å –∫ `Dockerfile` –≤–Ω—É—Ç—Ä–∏ `ctx.tar.gz`.

–ß—Ç–µ–Ω–∏–µ `Dockerfile` –∏–∑ `STDIN` –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

```bash
docker build - < Dockerfile
```

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–∞ –∫ –æ–±—Ä–∞–∑—É:

```bash
docker build -t myname/my-image:latest .
```

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `Dockerfile`:

```bash
docker build -f Dockerfile.debug .
```

–≠–∫—Å–ø–æ—Ä—Ç —Ñ–∞–π–ª–æ–≤ —Å–±–æ—Ä–∫–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `out`:

```bash
docker build -o out .
```

–≠–∫—Å–ø–æ—Ä—Ç —Ñ–∞–π–ª–æ–≤ —Å–±–æ—Ä–∫–∏ –≤ —Ñ–∞–π–ª `out.tar`:

```bash
docker build -o - . > out.tar
```

__`docker exec`__

–ö–æ–º–∞–Ω–¥–∞ `docker exec` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –≤ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

```bash
# —Å–∏–≥–Ω–∞—Ç—É—Ä–∞
docker exec [OPTIONS] CONTAINER COMMAND [ARG...]
# –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–∞–≥–∏
-d - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
-e - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è
-i - –æ—Å—Ç–∞–≤–∏—Ç—å `STDIN` –æ—Ç–∫—Ä—ã—Ç—ã–º
-t - –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø—Å–µ–≤–¥–æ—Ç–µ—Ä–º–∏–Ω–∞–ª–∞
-w - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```

–ü—Ä–∏–º–µ—Ä:

```bash
# -U - —ç—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —è–≤–ª—è–µ—Ç—Å—è root
docker exec -it postgres psql -U postgres
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ `postgres` –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª [`psql`](https://postgrespro.ru/docs/postgresql/14/app-psql). –í—ã–ø–æ–ª–Ω–∏–º –ø–∞—Ä–æ—á–∫—É –∫–æ–º–∞–Ω–¥:

```bash
# –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
\l
# –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö mydb
-d mydb
# –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü, —Ç–æ—á–Ω–µ–µ, —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π (relations)
\dt
# –≤—ã—Ö–æ–¥–∏–º
\q
```

__`docker ps`__

–ö–æ–º–∞–Ω–¥–∞ `docker ps` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–æ–ª—å–∫–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö) –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

```bash
# —Å–∏–≥–Ω–∞—Ç—É—Ä–∞
docker ps [OPTIONS]
# –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–∞–≥–∏
-a - –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–∫–∞–∫ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ, —Ç–∞–∫ –∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ)
-f - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Å–ª–æ–≤–∏—è (`id`, `name`, `status` –∏ —Ç.–¥.)
-n - –ø–æ–∫–∞–∑–∞—Ç—å n –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
-l - –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
# –ø—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps -f 'status=paused'
```

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –æ–±—Ä–∞–∑–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `docker images`.

__–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è__

```bash
# –∑–∞–ø—É—Å–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker start CONTAINER

# –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker pause CONTAINER

# –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker stop CONTAINER

# "—É–±–∏–π—Å—Ç–≤–æ" –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker kill CONTAINER

# –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker restart CONTAINER

# —É–¥–∞–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker rm [OPTIONS] CONTAINER
# –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–∞–≥–∏
-f - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ) –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
-v - —É–¥–∞–ª–µ–Ω–∏–µ –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö —Ç–æ–º–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
# –ø—Ä–∏–º–µ—Ä —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker rm $(docker ps --filter status=exited -q)

# —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞
docker rmi IMAGE

###

# —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞–º–∏
docker image COMMAND

# —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
docker container COMMAND

# —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–º–∞–º–∏
docker volume COMMAND

# —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç—è–º–∏
docker network COMMAND

# —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ docker
docker system COMMAND
```

__–î—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã__

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–≥–æ–≤ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `docker logs`:

```bash
docker logs [OPTIONS] CONTAINER
# –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–∞–≥–∏
-f - —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞ –≤—ã–≤–æ–¥–æ–º
-n - n –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å—Ç—Ä–æ–∫
```

–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Å–µ—Ç–∏, –æ–±—Ä–∞–∑—ã –∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ç–æ–º–∞) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `docker system prune`. –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–∞–≥–∏:

```bash
-a - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –æ–±–æ—Å–æ–±–ª–µ–Ω–Ω—ã—Ö (dangling)
--volumes - —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–º–æ–≤
```

_–ü—Ä–µ–¥–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–∏–µ_: –ø—Ä–∏–º–µ–Ω—è—Ç—å —ç—Ç—É –∫–æ–º–∞–Ω–¥—É —Å–ª–µ–¥—É–µ—Ç —Å –∫—Ä–∞–π–Ω–µ–π –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é, –ø–æ—Å–∫–æ–ª—å–∫—É —É–¥–∞–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–¥–ª–µ–∂–∞—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é.

[–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –∏ —Ñ–ª–∞–≥–æ–≤](https://docs.docker.com/engine/reference/commandline/docker/).

### Dockerfile

`Dockerfile` - —ç—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è), —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞–∑–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `docker build`.

_–ü—Ä–µ–¥–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–∏–µ_: –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/` –≤ –∫–∞—á–µ—Å—Ç–≤–µ `PATH` –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–±–æ—Ä–∫–∏. –≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø–µ—Ä–µ–¥–∞—á–µ –¥–µ–º–æ–Ω—É –≤—Å–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∂–µ—Å—Ç–∫–æ–≥–æ –¥–∏—Å–∫–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω—ã.

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –æ–¥–Ω–æ–π. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ –≤–∏–¥–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–ª–æ–µ–≤ –æ–±—Ä–∞–∑–∞. _–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: –∫–∞–∂–¥–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥—Ä—É–≥–∏—Ö. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ `RUN cd /tmp` –Ω–µ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –Ω–∏–∫–∞–∫–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.

`Dockerfile` –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:

```bash
# –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
–ò–ù–°–¢–†–£–ö–¶–ò–Ø –∞—Ä–≥—É–º–µ–Ω—Ç—ã


# –û—Å–Ω–æ–≤–Ω—ã–µ
# FROM - —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–∑
FROM <image>[:<tag>] [AS <name>]
# –ø—Ä–∏–º–µ—Ä
FROM node:12-alpine AS build


# WORKDIR - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π RUN, CMD, ENTRYPOINT, COPY –∏ ADD
WORKDIR /path/to/dir
# –ø—Ä–∏–º–µ—Ä
WORKDIR /app


# COPY - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏–∑ <src>
# –∏ –∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–∞–∑–∞ –ø–æ –∞–¥—Ä–µ—Å—É, —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –≤ <dest>
COPY <src> <dest>
COPY ["<src>", "<dest>"]
# –ø—Ä–∏–º–µ—Ä
COPY package.* yarn.lock ./
# –∏–ª–∏
COPY . .
# ADD, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç COPY, –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã,
# –∞ —Ç–∞–∫–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç —Å–∂–∞—Ç—ã–µ (identity, gzip, bzip2 –∏–ª–∏ xz) –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã


# ADD - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤, –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏–ª–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ (!) —Ñ–∞–π–ª–∞ –∏–∑ <src>
# –∏ –∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–∞–∑–∞ –ø–æ –∞–¥—Ä–µ—Å—É, —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –≤ <dest>
ADD <src> <dest>
ADD ["<src>", "<dest>"]
# –ø—Ä–∏–º–µ—Ä
ADD some.txt some_dir/ # <WORKING_DIR>/some_dir/


# RUN - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ –Ω–æ–≤–æ–º —Å–ª–æ–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ –æ–±—Ä–∞–∑–∞ –∏ —Ñ–∏–∫—Å–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
RUN <command>
# –∏–ª–∏
RUN ["executable", "arg1", "arg2"] # –ö–∞–≤—ã—á–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–≤–æ–π–Ω—ã–º–∏
# –ø—Ä–∏–º–µ—Ä
RUN npm install


# CMD - –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
CMD ["executable", "arg1", "arg2"]
# –∏–ª–∏ –µ—Å–ª–∏ –¥–∞–Ω–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è ENTRYPOINT
CMD ["arg1", "arg2"]
# –∏–ª–∏
CMD command arg1 arg2
# –ø—Ä–∏–º–µ—Ä
CMD [ "node", "/app/src/index.js" ]
# RUN –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –∏ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç,
# CMD –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏, –∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –¥–ª—è –æ–±—Ä–∞–∑–∞
# (!) –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ (–ø–æ—Å–ª–µ–¥–Ω—è—è) –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è CMD


# ENTRYPOINT - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
ENTRYPOINT ["executable", "arg1", "arg2"]
ENTRYPOINT command arg1 arg2
# –ø—Ä–∏–º–µ—Ä
ENTRYPOINT ["top", "-b"]
CMD ["-c"]
# docker run -it --rm --name test top -H
# top -b -H
# —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É ENTRYPOINT –∏ CMD:
# https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact
# https://stackoverflow.com/questions/21553353/what-is-the-difference-between-cmd-and-entrypoint-in-a-dockerfile


# –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
# ${var} –∏–ª–∏ $var
# –ø—Ä–∏–º–µ—Ä
FROM busybox
ENV FOO=/bar
WORKDIR ${FOO}    # WORKDIR /bar
ADD . $FOO        # ADD . /bar
COPY \$FOO /qux   # COPY $FOO /qux


# –î—Ä—É–≥–∏–µ
# LABEL - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∫ –æ–±—Ä–∞–∑—É
LABEL <key>=<value>
# –ø—Ä–∏–º–µ—Ä
LABEL version="1.0"


# EXPOSE - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ç–µ–≤–æ–º –ø–æ—Ä—Ç–µ, –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ–º–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
EXPOSE <port> | <port>/<protocol>
# –ø—Ä–∏–º–µ—Ä
EXPOSE 3000


# ENV - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è
ENV <key>=<value>
# –ø—Ä–∏–º–µ—Ä
ENV MY_NAME="No Name"


# VOLUME - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
VOLUME ["/var/log"]
VOLUME /var/log


# USER - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
# –≤ –ª—é–±—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö RUN, CMD –∏ ENTRYPOINT
USER <user>[:<group>]
USER <UID>[:<GID>]


# ARG - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –ø—Ä–∏
# –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `docker build` —Å –ø–æ–º–æ—â—å—é —Ñ–ª–∞–≥–∞ `--build-arg <name>=<value>`
ARG <name>[=<default value>]


# ONBUILD - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –æ–±—Ä–∞–∑ —Ç—Ä–∏–≥–≥–µ—Ä–∞, –∑–∞–ø—É—Å–∫–∞–µ–º–æ–≥–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
# –¥–∞–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤—ã –¥–ª—è –¥—Ä—É–≥–æ–π —Å–±–æ—Ä–∫–∏
ONBUILD <INSTRUCTION>
```

[`–°–ø—Ä–∞–≤–∫–∞ –ø–æ Dockerfile`](https://docs.docker.com/engine/reference/builder/).

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ Dockerfile

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ª–µ–¥—É—é—â–∏–π `Dockerfile`:

```bash
# syntax=docker/dockerfile:1
FROM ubuntu:18.04
COPY . /app
RUN make /app
CMD python /app/app.py
```

–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–∫—Ä–æ–º–µ `CMD`) –∏–∑ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–æ–≤–æ–≥–æ —Å–ª–æ—è:

- `FROM` —Å–æ–∑–¥–∞–µ—Ç —Å–ª–æ–π –∏–∑ –æ–±—Ä–∞–∑–∞ `ubuntu:18.04`
- `COPY` –¥–æ–±–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- `RUN` —Å–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é [`make`](https://www.gnu.org/software/make/)
- `CMD` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –æ–±—Ä–∞–∑–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Å–ª–æ–π, –¥–æ—Å—Ç—É–ø–Ω—ã–π –¥–ª—è –∑–∞–ø–∏—Å–∏, –ø–æ–≤–µ—Ä—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤, –∏—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —ç—Ç–æ—Ç —Å–ª–æ–π.

_–°–æ–∑–¥–∞–Ω–∏–µ —ç—Ñ–µ–º–µ—Ä–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤_

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ–µ–º–µ—Ä–Ω—ã–º–∏. –ü–æ–¥ —ç—Ñ–µ–º–µ—Ä–Ω–æ—Å—Ç—å—é –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏, —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è, –ø–æ–≤—Ç–æ—Ä–Ω–æ–π —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–º–µ–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

_–ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–±–æ—Ä–∫–∏_

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `docker build` –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º —Å–±–æ—Ä–∫–∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —è–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è. –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ `Dockerfile` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏. –ü—É—Ç—å –∫ `Dockerfile`, –Ω–∞—Ö–æ–¥—è—â–µ–º—É—Å—è –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ, –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ–ª–∞–≥–∞ `-f`. –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è `Dockerfile`, –≤—Å–µ —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–∑ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –¥–µ–º–æ–Ω—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–±–æ—Ä–∫–∏.

–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã

- —Å–æ–∑–¥–∞–µ–º (`mkdir`) –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `myapp`, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–±–æ—Ä–∫–∏
- –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–µ–µ (`cd`)
- —Å–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª `hello` —Å —Ç–µ–∫—Å—Ç–æ–º `"hello"`
- —Å–æ–∑–¥–∞–µ–º `Dockerfile`, —á–∏—Ç–∞—é—â–∏–π (`cat`) —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `hello`
- —Å–æ–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–∑ —Å —Ç–µ–≥–æ–º `helloapp:v1`

```bash
mkdir myapp && cd myapp
echo "hello" > hello
echo -e "FROM busybox\nCOPY /hello /\nRUN cat /hello" > Dockerfile
docker build -t helloapp:v1 .
```

–†–∞–∑–º–µ—â–∞–µ–º `Dockerfile` –∏ `hello` –≤ —Ä–∞–∑–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö –∏ —Å–æ–±–∏—Ä–∞–µ–º –≤—Ç–æ—Ä—É—é –≤–µ—Ä—Å–∏—é –æ–±—Ä–∞–∑–∞ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–µ—à–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–±–æ—Ä–∫–∏ (`-f` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—É—Ç—å –∫ `Dockerfile`):

```bash
# —Å–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p dockerfiles context
# –ø–µ—Ä–µ–º–µ—â–∞–µ–º —Ñ–∞–π–ª—ã
mv Dockerfile dockerfiles && mv hello context
# —Å–æ–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–∑
docker build --no-cache -t helloapp:v2 -f dockerfiles/Dockerfile context
```

_`.dockerignore`_

–í —Ñ–∞–π–ª–µ `.dockerignore` —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã, –Ω–µ –∏–º–µ—é—â–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ —Å–±–æ—Ä–∫–µ –∏ –ø–æ—ç—Ç–æ–º—É –Ω–µ –≤–∫–ª—é—á–∞–µ–º—ã–µ –≤ –Ω–µ–µ. –°–∏–Ω—Ç–∞–∫—Å–∏—Å `.dockerignore` –ø–æ—Ö–æ–∂ –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `.gitignore` –∏–ª–∏ `.npmignore`.

_–ú–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω–∞—è —Å–±–æ—Ä–∫–∞_

–ú–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω–∞—è —Å–±–æ—Ä–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑—É—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–±–æ—Ä–∫–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –Ω–∞–ª–∏—á–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–ª–æ–µ–≤ –∏ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å.

–ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª–æ–µ–≤, –º—ã –º–æ–∂–µ–º —É–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –∏—Ö –æ—Ç —Ä–µ–¥–∫–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã—Ö –¥–æ —á–∞—Å—Ç–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã—Ö:

- —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü—Ä–∏–º–µ—Ä `Dockerfile` –¥–ª—è `Go-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è`:

```bash
# syntax=docker/dockerfile:1
FROM golang:1.16-alpine AS build

# —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
# –≤—ã–ø–æ–ª–Ω—è–µ–º `docker build --no-cache .` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN apk add --no-cache git
RUN go get github.com/golang/dep/cmd/dep

# —Å–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏–∑ `Gopkg.toml` –∏ `Gopkg.lock`
# —ç—Ç–∏ —Å–ª–æ–∏ –±—É–¥—É—Ç —Å–æ–±–∏—Ä–∞—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ `Gopkg`
COPY Gopkg.lock Gopkg.toml /go/src/project/
WORKDIR /go/src/project/
# —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN dep ensure -vendor-only

# –∫–æ–ø–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç –∏ —Å–æ–±–∏—Ä–∞–µ–º –µ–≥–æ
# —ç—Ç–æ—Ç —Å–ª–æ–π –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `project`
COPY . /go/src/project/
RUN go build -o /bin/project

# –ø–æ–ª—É—á–∞–µ–º –æ–±—Ä–∞–∑, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –æ–¥–Ω–æ–≥–æ —Å–ª–æ—è
FROM scratch
COPY --from=build /bin/project /bin/project
ENTRYPOINT ["/bin/project"]
CMD ["--help"]
```

_–õ–∏—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏_

–î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –≤—Ä–µ–º–µ–Ω–∏ —Å–±–æ—Ä–∫–∏ —Å–ª–µ–¥—É–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –Ω–µ–Ω—É–∂–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ "–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π".

_–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π_

–ö–∞–∂–¥—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –æ–¥–Ω—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å (single responsibility). –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –æ–±–ª–µ–≥—á–∞–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–µ–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ 3 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –∫–∞–∂–¥—ã–π —Å–æ —Å–≤–æ–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º, –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∫–µ—à–∞, —Ö—Ä–∞–Ω—è—â–µ–≥–æ—Å—è –≤ –ø–∞–º—è—Ç–∏. –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–≤–∏—Å—è—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ç–∏.

_–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ª–æ–µ–≤_

–í —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö `Docker` –∫–∞–∂–¥–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤ `Dockerfile` –ø—Ä–∏–≤–æ–¥–∏–ª–∞ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–æ–≤–æ–≥–æ —Å–ª–æ—è. –°–µ–π—á–∞—Å –Ω–æ–≤—ã–µ —Å–ª–æ–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ `RUN`,`COPY` –∏ `ADD`. –î—Ä—É–≥–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ–±—Ä–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —É–≤–µ–ª–∏—á–µ–Ω–∏—é —Ä–∞–∑–º–µ—Ä–∞ —Å–±–æ—Ä–∫–∏.

_–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤_

–ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –¢–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–ª—è—Ç—å –ø—Ä–æ–±–µ–ª –ø–µ—Ä–µ–¥ –æ–±—Ä–∞—Ç–Ω—ã–º —Å–ª—ç—à–µ–º (`\`). –ü—Ä–∏–º–µ—Ä:

```bash
RUN apt-get update && apt-get install -y \
 bzr \
 cvs \
 git \
 mercurial \
 subversion \
 && rm -rf /var/lib/apt/lists/*
```

_–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–µ—à–∞ —Å–±–æ—Ä–∫–∏_

–ü—Ä–∏ —Å–±–æ—Ä–∫–µ –æ–±—Ä–∞–∑–∞ `Docker` –∏–∑—É—á–∞–µ—Ç –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ –ø–æ—Ä—è–¥–∫–µ, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –≤ `Dockerfile`. –ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `Docker` –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ —Å–≤–æ–µ–º—É –∫–µ—à—É. –ï—Å–ª–∏ –≤ –∫–µ—à–µ –∏–º–µ–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –æ–±—Ä–∞–∑, –Ω–æ–≤—ã–π –æ–±—Ä–∞–∑ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è. –î–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –∫–µ—à—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `--no-cache=true`.

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º

_FROM_

–í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞–∑–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–∑—ã –∏–∑ `DockerHub` –≤–µ—Ä—Å–∏–∏ `alpine`.

_LABEL_

–ü–æ–¥–ø–∏—Å–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–∑—ã –ø—Ä–æ–µ–∫—Ç–∞, –¥–æ–±–∞–≤–ª—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª–∏—Ü–µ–Ω–∑–∏—è—Ö, –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ —Ç.–¥.

```bash
# –æ–¥–Ω–∞ –ø–æ–¥–ø–∏—Å—å
LABEL com.example.version="0.0.1-beta"
# –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å–µ–π
LABEL vendor=ACME\ Incorporated \
     com.example.is-beta= \
     com.example.is-production="" \
     com.example.version="0.0.1-beta" \
     com.example.release-date="2021-01-12"
```

_RUN_

–î–ª–∏–Ω–Ω—ã–µ –∏ —Å–ª–æ–∂–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `RUN` —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª—è—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ —Å –ø–æ–º–æ—â—å—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Å–ª—ç—à–∞ (`\`). –≠—Ç–æ –¥–µ–ª–∞–µ—Ç `Dockerfile` –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º, –æ–±–ª–µ–≥—á–∞–µ—Ç –µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É.

```bash
RUN apt-get update && apt-get install -y \
   package-bar \
   package-baz \
   package-foo  \
   && rm -rf /var/lib/apt/lists/*
```

_CMD_

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `CMD` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –≤–º–µ—Å—Ç–µ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏. `CMD` –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ñ–æ—Ä–º–µ `CMD ["executable", "param1", "param2"]`. –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –ø–µ—Ä–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª, —Ç–∞–∫–æ–π –∫–∞–∫ `bash`, `python` –∏–ª–∏ `perl`. –ù–∞–ø—Ä–∏–º–µ—Ä, `CMD ["perl", "-de0"]`, `CMD ["python"]` –∏–ª–∏ `CMD ["php", "-a"]`. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `ENTRYPOINT` —Å–ª–µ–¥—É–µ—Ç —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–Ω–∏–º–∞—é—Ç, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è.

_EXPOSE_

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `EXPOSE` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—Ç—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞–∑, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä `Apache`, –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `EXPOSE 80`, –∞ –æ–±—Ä–∞–∑, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π `MonghoDB` - `EXPOSE 27017`.

_ENV_

–î–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ENV` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è `PATH` –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º. –ù–∞–ø—Ä–∏–º–µ—Ä, `ENV PATH=/usr/local/nginx/bin:$PATH` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç, —á—Ç–æ `CMD ["nginx"]` –ø—Ä–æ—Å—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `ENV` —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ `PGDATA` –¥–ª—è `Postgres`.

–ù–∞–∫–æ–Ω–µ—Ü, `ENV` –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–æ–º–µ—Ä–æ–≤ –≤–µ—Ä—Å–∏–π, —á—Ç–æ –æ–±–ª–µ–≥—á–∞–µ—Ç –∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.

_ADD –∏–ª–∏ COPY_

–•–æ—Ç—è `ADD` –∏ `COPY` –∏–º–µ—é—Ç –ø–æ—Ö–æ–∂–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `COPY`, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è –±–æ–ª–µ–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π, —á–µ–º `ADD`. `COPY` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –∞ `ADD` —Ç–∞–∫–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ñ–∞–π–ª—ã –∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∞—Ä—Ö–∏–≤–æ–≤ –∏ –ø–æ–ª—É—á–∞—Ç—å —Ñ–∞–π–ª—ã –ø–æ `URL`, –Ω–æ –≤–º–µ—Å—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `curl` –∏–ª–∏ `wget`: —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–¥–∞–ª—è—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è.

–ï—Å–ª–∏ `Dockerfile` —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —ç—Ç–∞–ø–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, —ç—Ç–∏ —Ñ–∞–π–ª—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é –∫–µ—à–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä:

```bash
COPY package.json /app
RUN npm i
# –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è node_modules —É–∫–∞–∑–∞–Ω–∞ –≤ .dockerignore
COPY . /app
```

_ENTRYPOINT_

`ENTRYPOINT` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è –æ–±—Ä–∞–∑–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–±—Ä–∞–∑ –±–µ–∑ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä –æ–±—Ä–∞–∑–∞ –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ `s3cmd`:

```bash
ENTRYPOINT ["s3cmd"]
CMD ["--help"]
```

–î–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑ –º–æ–∂–µ—Ç –±—ã—Ç –∑–∞–ø—É—â–µ–Ω —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```bash
docker run s3cmd
```

–≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –≤—ã–≤–æ–¥—É —Å–ø—Ä–∞–≤–∫–∏.

–õ–∏–±–æ –º—ã –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã:

```bash
docker run s3cmd ls s3://mybucket
```

–≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—Ä–∞–∑–∞ —Å–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª.

_VOLUME_

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `VOLUME` —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ª—é–±–æ–π –æ–±–ª–∞—Å—Ç–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω–∏–ª–∏—â—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–ª–∏ —Ñ–∞–π–ª–∞–º/–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º, —Å–æ–∑–¥–∞–Ω–Ω—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º. –ö—Ä–∞–π–Ω–µ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `VOLUME` –¥–ª—è –º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö –∏/–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —á–∞—Å—Ç–µ–π –æ–±—Ä–∞–∑–∞.

_WORKDIR_

–î–ª—è —è—Å–Ω–æ—Å—Ç–∏ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è `WORKDIR` –≤—Å–µ–≥–¥–∞ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏. –¢–∞–∫–∂–µ `WORKDIR` —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–º–µ—Å—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Ç–∏–ø–∞ `RUN cd ... && do-something`, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä—É–¥–Ω–æ —á–∏—Ç–∞—Ç—å, –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å.

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ñ–∞–π–ª—ã, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å–ª–æ–µ, –¥–æ—Å—Ç—É–ø–Ω–æ–º –¥–ª—è –∑–∞–ø–∏—Å–∏ (writable layer). –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

- –¥–∞–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∏ –∏—Ö —Å–ª–æ–∂–Ω–æ –∏–∑–≤–ª–µ–∫–∞—Ç—å –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∫–æ–≥–¥–∞ –≤ –Ω–∏—Ö –Ω—É–∂–¥–∞–µ—Ç—Å—è –¥—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å
- —Å–ª–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –¥–æ—Å—Ç—É–ø–Ω—ã–π –¥–ª—è –∑–∞–ø–∏—Å–∏, —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω —Å —Ö–æ—Å—Ç–æ–º, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –∑–∞–ø—É—â–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. –î–∞–Ω–Ω—ã–µ –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ –≤–∑—è—Ç—å –∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –¥—Ä—É–≥–æ–µ –º–µ—Å—Ç–æ
- –∑–∞–ø–∏—Å—å –≤ —Ç–∞–∫–æ–π —Å–ª–æ–π —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (storage driver) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π. –≠—Ç–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è —Å–Ω–∏–∂–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ç–æ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (data volumes), –∫–æ—Ç–æ—Ä—ã–µ –ø–∏—à—É—Ç –Ω–∞–ø—Ä—è–º—É—é –≤ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

`Docker` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç 2 –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ö–æ—Å—Ç–µ: —Ç–æ–º–∞ (volumes) –∏ `bind mount`. –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π `Linux` —Ç–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω `tmpfs mount`, –∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π `Windows` - `named pipe`.

__–í—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–∏–ø–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è__

–ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–∞–Ω–Ω—ã–µ –≤—ã–≥–ª—è–¥—è—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ. –û–Ω–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏–ª–∏ —Ñ–∞–π–ª –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ç–æ–º–∞–º–∏, `bind mount` –∏ `tmpfs mount` –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ö–æ—Å—Ç–µ.

<img src="https://habrastorage.org/webt/zw/uh/4h/zwuh4hf842ombg9qhug0rophhyk.png" alt="" />
<br />

- —Ç–æ–º–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —á–∞—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Ö–æ—Å—Ç–∞, —É–ø—Ä–∞–≤–ª—è–µ–º–æ–π `Docker` (`/var/lib/docker/volumes/` –Ω–∞ `Linux`). –ü—Ä–æ—Ü–µ—Å—Å—ã, –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ `Docker`, –Ω–µ –¥–æ–ª–∂–Ω—ã –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É —á–∞—Å—Ç—å. –¢–æ–º–∞ - –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ `Docker`
- `bind mount` –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ —Å–∏—Å—Ç–µ–º—ã —Ö–æ—Å—Ç–∞. –≠—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–∞–∂–µ –≤–∞–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏. –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –º–æ–≥—É—Ç –ª—é–±—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- `tmpfs mount` —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –∏ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –≤ `Docker`](https://docs.docker.com/storage/).

__–¢–æ–º–∞__

–¢–æ–º–∞ (Volumes) - –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏. –û–Ω–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è `Docker`, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç `bind mount`, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Ö–æ—Å—Ç–∞. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–æ–º–æ–≤ —Å–æ—Å—Ç–æ—è—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º:

- —Ç–æ–º–∞ –ª–µ–≥—á–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å
- —Ç–æ–º–∞–º–∏ –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å –ø–æ–º–æ—â—å—é `Docker CLI` –∏ `Docker API`
- —Ç–æ–º–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –≤ `Linux`, —Ç–∞–∫ –∏ –≤ `Windows` –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
- —Ç–æ–º–∞ –º–æ–≥—É—Ç –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
- –¥–≤–∏–∂–∫–∏ —Ç–æ–º–æ–≤ (volume drivers) –ø–æ–∑–≤–æ–ª—è—é—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–º–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Ö–æ—Å—Ç–∞—Ö –∏ –æ–±–ª–∞—á–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞—Ö, —à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–æ–º–æ–≤ –∏–ª–∏ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –Ω–∏—Ö –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–æ–≤—ã—Ö —Ç–æ–º–æ–≤ –º–æ–∂–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è (population) –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
- —Ç–æ–º–∞ –∏–º–µ—é—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–¢–æ–º–∞ —Ç–∞–∫–∂–µ —è–≤–ª—è—é—Ç—Å—è –±–æ–ª–µ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –≤ —Å–ª–æ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –¥–æ—Å—Ç—É–ø–Ω–æ–º –¥–ª—è –∑–∞–ø–∏—Å–∏, –ø–æ—Å–∫–æ–ª—å–∫—É —Ç–æ–º–∞ –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

__–§–ª–∞–≥–∏ `-v` –∏ `--mount`__

`--mount` —è–≤–ª—è–µ—Ç—Å—è –±–æ–ª–µ–µ —è–≤–Ω—ã–º –∏ –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–º. –û—Å–Ω–æ–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `-v` –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç—Å—è –≤–º–µ—Å—Ç–µ, –∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `--mount` –æ–Ω–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ä–∞–∑–¥–µ–ª—å–Ω–æ.

–î–≤–∏–∂–æ–∫ —Ç–æ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω —Ç–æ–ª—å–∫–æ —Å –ø–æ–º–æ—â—å—é `--mount`.

- `-v` –∏–ª–∏ `--volume`: —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 3 –ø–æ–ª–µ–π, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–≤–æ–µ—Ç–æ—á–∏–µ–º (`:`). –ü–æ–ª—è –¥–æ–ª–∂–Ω—ã —É–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –ó–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ—á–µ–≤–∏–¥–Ω—ã–º
 - –≤ —Å–ª—É—á–∞–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–º–æ–≤ –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ - —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–º–∞, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ö–æ—Å—Ç–∞. –í —Å–ª—É—á–∞–µ –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö —Ç–æ–º–æ–≤ —ç—Ç–æ –ø–æ–ª–µ –æ–ø—É—Å–∫–∞–µ—Ç—Å—è
 - –≤—Ç–æ—Ä–æ–µ –ø–æ–ª–µ - —ç—Ç–æ –ø—É—Ç—å —Ñ–∞–π–ª–∞ –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –º–æ–Ω—Ç–∏—Ä—É–µ–º–æ–π –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
 - —Ç—Ä–µ—Ç—å–µ –ø–æ–ª–µ —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–π –∑–∞–ø—è—Ç—ã–º–∏ —Å–ø–∏—Å–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫, —Ç–∞–∫–∏—Ö –∫–∞–∫ `ro`
- `--mount`: —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä –∫–ª—é—á/–∑–Ω–∞—á–µ–Ω–∏–µ, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—è—Ç—ã–º–∏. –°–∏–Ω—Ç–∞–∫—Å–∏—Å `--mount` —è–≤–ª—è–µ—Ç—Å—è –±–æ–ª–µ–µ –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–º, –∑–∞—Ç–æ –ø–æ—Ä—è–¥–æ–∫ –∫–ª—é—á–µ–π –Ω–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è, –∞ –∑–Ω–∞—á–µ–Ω–∏—è –∫–ª—é—á–µ–π —è–≤–ª—è—é—Ç—Å—è –±–æ–ª–µ–µ –æ—á–µ–≤–∏–¥–Ω—ã–º–∏
   - `type`: —Ç–∏–ø –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `bind`, `volume` –∏–ª–∏ `tmpfs`
   - `source`: –∏—Å—Ç–æ—á–Ω–∏–∫ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –î–ª—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–º–æ–≤ - —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–º–∞. –î–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—É—â–µ–Ω–æ. –ú–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –∫–∞–∫ `source` –∏–ª–∏ `src`
   - `destination`: –ø—É—Ç—å –º–æ–Ω—Ç–∏—Ä—É–µ–º–æ–≥–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Ñ–∞–π–ª–∞ –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏. –ú–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –∫–∞–∫ `destination`, `dst` –∏–ª–∏ `target`
   - `readonly`: –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ –¥–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, —Ç–æ–º –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è. –ú–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –∫–∞–∫ `readonly` –∏–ª–∏ `ro`
   - `volume-opt`: –¥–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –ø—Ä–∏–Ω–∏–º–∞—è –ø–∞—Ä—ã –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏/–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

`-v` –∏ `--mount` –ø—Ä–∏–Ω–∏–º–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ç–æ–º–æ–≤ —Å —Å–µ—Ä–≤–∏—Å–∞–º–∏, –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ —Ñ–ª–∞–≥ `--mount`.

__–°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–º–∞–º–∏__

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç `bind mount`, —Ç–æ–º–∞ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ª—é–±–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

_–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–º–∞_

```bash
docker volume create my-vol
```

_–°–ø–∏—Å–æ–∫ —Ç–æ–º–æ–≤_

```bash
docket volume ls
```

_–ê–Ω–∞–ª–∏–∑ —Ç–æ–º–∞_

```bash
docker volume inspect my-vol
```

_–£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–º–∞_

```bash
docker volume rm my-vol
```

__–ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å —Ç–æ–º–æ–º__

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ç–æ–º–æ–º, –æ–Ω —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ —Ç–æ–º `myvol2` –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `app` –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
docker run -d \
 --name devtest \
 -v myvol2:/app \
 nginx:latest

# –∏–ª–∏
docker run -d \
 --name devtest \
 --mount source=myvol2,target=/app \
 nginx:latest
# –¥–∞–ª–µ–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ `-v`
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Ç–æ–º –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ –¥–ª—è —á—Ç–µ–Ω–∏—è, —Ç–∞–∫ –∏ –¥–ª—è –∑–∞–ø–∏—Å–∏.

__–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–º–∞ —Å `Docker Compose`__

–ï–¥–∏–Ω–∏—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å (single service) `Compose` —Å —Ç–æ–º–æ–º –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

```yml
version: "1.0"
services:
 frontend:
   image: node:lts
   volumes:
     - myapp:/home/node/app
volumes:
 myapp:
```

–¢–æ–º –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ `docker compose up`. –ü—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –≤—ã–∑–æ–≤–∞—Ö –¥–∞–Ω–Ω—ã–π —Ç–æ–º –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ.

–¢–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω –æ—Ç–¥–µ–ª—å–Ω–æ —Å –ø–æ–º–æ—â—å—é `docker volume create`. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤ `docker-compose.yml` –º–æ–∂–µ—Ç –±—ã—Ç—å —É–∫–∞–∑–∞–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–Ω–µ—à–Ω–∏–π (external) —Ç–æ–º:

```yml
version: "1.0"
services:
 frontend:
   image: node:lts
   volumes:
     - myapp:/home/node/app
volumes:
 myapp:
   external: true
```

__–ü–æ–ø—É–ª—è—Ü–∏—è —Ç–æ–º–∞ —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞__

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, —Å–æ–∑–¥–∞—é—â–µ–≥–æ —Ç–æ–º, –∫–æ–≥–¥–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –º–æ–Ω—Ç–∏—Ä—É–µ–º–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ —Ç–æ–º. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–º. –î—Ä—É–≥–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ —Ç–æ–º, –±—É–¥—É—Ç –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ –µ–≥–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–º—É (pre-populated) —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É.

–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã —Å–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `nginxtest` –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –Ω–æ–≤—ã–π —Ç–æ–º `nginx-vol` —Å–æ–¥–µ—Ä–∂–∏–º—ã–º –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/usr/share/nginx/html`, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞:

```bash
docker run -d \
 --name=nginxtest \
 -v nginx-vol:/usr/share/nginx/html \
 nginx:latest
```

_–ü—Ä–∏–º–µ—Ä –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–º–∞, –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è_

```bash
# :ro
docker run -d \
 --name=nginxtest \
 -v nginx-vol:/usr/share/nginx/html:ro \
 nginx:latest
```

__–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–º–æ–≤__

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –º–æ–Ω—Ç–∏—Ä—É—é—â–µ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ç–æ–º, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–ª–∞–≥ `--volumes-from`.

_–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–∞_

–°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `dbstore`:

```bash
docker run -v /dbdata --name dbstore ubuntu /bin/bash
```

–°–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞

- –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –≤ –Ω–µ–≥–æ —Ç–æ–º –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `dbstore`
- –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ –∫–∞–∫ `/backup`
- –ø–µ—Ä–µ–¥–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ç–æ–º–∞ `dbdata` –≤ —Ñ–∞–π–ª `backup.tar` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/backup`:

```bash
docker run --rm \
 --volumes-from dbstore \
 -v $(pwd):/backup \
 ubuntu tar \
 cvf /backup/backup.tar /dbdata
```

_–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–º–∞_

–°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:

```bash
docker run -d \
 -v /dbdata \
 --name dbstore2 \
 ubuntu /bin/bash
```

–†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –∞—Ä—Ö–∏–≤ –≤ —Ç–æ–º –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
docker run --rm \
 --volumes-from dbstore2 \
 -v $(pwd):/backup \
 ubuntu bash -c \
 "cd /dbdata && tar xvf /backup/backup.tar --strip 1"
```

_–£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–º–æ–≤_

–î–∞–Ω–Ω—ã–µ —Ç–æ–º–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –°—É—â–µ—Å—Ç–≤—É–µ—Ç 2 —Ç–∏–ø–∞ —Ç–æ–º–æ–≤:

- –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ: –∏–º–µ—é—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, `awesome:/foo`
- –∞–Ω–æ–Ω–∏–º–Ω—ã–µ: –Ω–µ –∏–º–µ—é—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–µ–º–æ–Ω—É —Å–ª–µ–¥—É–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Ö —É–¥–∞–ª–µ–Ω–∏—é

–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–ª–∞–≥ `--rm`. –ù–∞–ø—Ä–∏–º–µ—Ä, –∑–¥–µ—Å—å –º—ã —Å–æ–∑–¥–∞–µ–º –∞–Ω–æ–Ω–∏–º–Ω—ã–π —Ç–æ–º `/foo` –∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–º `awesome:/bar`:

```bash
docker run --rm -v /foo -v awesome:/bar busybox top
```

–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω —Ç–æ–ª—å–∫–æ —Ç–æ–º `/foo`.

–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ç–æ–º–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `docker volume prune`.

–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º–∞—Ö –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å [–∑–¥–µ—Å—å](https://docs.docker.com/storage/volumes/).

### –°–µ—Ç–∏

–°–µ—Ç–∏ (Networks) –ø–æ–∑–≤–æ–ª—è—é—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º –æ–±—â–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π. –°–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Docker` –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ç–µ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∏–º–∏ –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏:

- `bridge` (–º–æ—Å—Ç): –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Å–µ—Ç–µ–≤–æ–π –¥—Ä–∞–π–≤–µ—Ä. –¢–∞–∫–∏–µ —Å–µ—Ç–∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—â–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π
- `host`: —ç—Ç–æ—Ç –¥—Ä–∞–π–≤–µ—Ä —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ç–∏ —Ö–æ—Å—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é, —É–¥–∞–ª—è—è –∏–∑–æ–ª—è—Ü–∏—é –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –∏ —Ö–æ—Å—Ç–æ–º
- `overlay` (–ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ): —Ç–∞–∫–∏–µ —Å–µ—Ç–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–µ–º–æ–Ω–æ–≤ –≤–º–µ—Å—Ç–µ –∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –≥—Ä—É–ø–ø–æ–≤—ã–º —Å–µ—Ä–≤–∏—Å–∞–º (swarm services) –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º. –≠—Ç–∏ —Å–µ—Ç–∏ —Ç–∞–∫–∂–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–æ–≤—ã–º —Å–µ—Ä–≤–∏—Å–æ–º –∏ –æ—Ç–¥–µ–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –∏–ª–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –¥–µ–º–æ–Ω–∞—Ö
- `ipvlan`: —Ç–∞–∫–∞—è —Å–µ—Ç—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∞–¥—Ä–µ—Å–∞—Ü–∏–µ–π `IPv4` –∏ `IPv6`
- `macvlan`: —ç—Ç–æ—Ç –¥—Ä–∞–π–≤–µ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏—Å–≤–∞–∏–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É `MAC-–∞–¥—Ä–µ—Å`, –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —á–µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–µ—Ç–∏ –∫–∞–∫ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- `none`: –æ—Ç–∫–ª—é—á–∞–µ—Ç —Å–µ—Ç–∏ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –û–±—ã—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –∫–∞—Å—Ç–æ–º–Ω–æ–º—É —Å–µ—Ç–µ–≤–æ–º—É –¥—Ä–∞–π–≤–µ—Ä—É
- –ø–ª–∞–≥–∏–Ω—ã

_–†–µ–∑—é–º–µ_

- `bridge`: –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ
- `host`: –∫–æ–≥–¥–∞ —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫ –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –æ—Ç —Ö–æ—Å—Ç–∞
- `overlay`: –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ö–æ—Å—Ç–∞—Ö, –∏–ª–∏ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤–º–µ—Å—Ç–µ —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã

[–û–±–∑–æ—Ä —Å–µ—Ç–µ–π](https://docs.docker.com/network/).

__–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π —Å–µ—Ç–∏ `bridge`__

–°–µ–π—á–∞—Å –º—ã –∑–∞–ø—É—Å—Ç–∏–º 2 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `alpine` –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –º–µ–∂–¥—É —Å–æ–±–æ–π.

- –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤—ã–ø–æ–ª–Ω—è–µ–º —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

```bash
docker network ls
```

–ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π `bridge`, `host` –∏ `none`.

- –ó–∞–ø—É—Å–∫–∞–µ–º 2 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `alpine`. `ash` - —ç—Ç–æ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª `Alpine` (–∞–Ω–∞–ª–æ–≥ `bash`). –§–ª–∞–≥–∏ `-dit` –æ–∑–Ω–∞—á–∞—é—Ç –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (-d), –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ (—á—Ç–æ–±—ã –¥–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã) (-i) –∏ —Å –ø—Å–µ–≤–¥–æ—Ç–µ—Ä–º–∏–Ω–∞–ª–æ–º (—á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –≤–≤–æ–¥ –∏ –≤—ã–≤–æ–¥) (-t). –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ–º `--network`, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π —Å–µ—Ç–∏ `bridge`:

```bash
# –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–æ–º–µ—Ä —Ä–∞–∑
docker run -dit --name alpine1 alpine ash

# –∏ –Ω–æ–º–µ—Ä –¥–≤–∞
docker run -dit --name alpine2 alpine ash
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–±–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∑–∞–ø—É—â–µ–Ω—ã:

```bash
docker container ls
# –∏–ª–∏
docker ps
```

- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–µ—Ç—å `bridge` –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫ –Ω–µ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
docker network inspect bridge
```

–í–∏–¥–∏–º —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –Ω–∞–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —Ä–∞–∑–¥–µ–ª–µ `"Containers"` –≤–º–µ—Å—Ç–µ —Å –∏—Ö `IP-–∞–¥—Ä–µ—Å–∞–º–∏` (`172.17.0.2` –¥–ª—è `alpine1` –∏ `172.17.0.3` –¥–ª—è `alpine2`).

- –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ `alpine1`:

```bash
docker attach alpine1
```

–í–∏–¥–∏–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ `#`, —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É—é—â–µ–µ –æ —Ç–æ–º, —á—Ç–æ –º—ã —è–≤–ª—è–µ–º—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º `root` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –í–∑–≥–ª—è–Ω–µ–º –Ω–∞ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `alpine1`:

```bash
id addr show
```

–ü–µ—Ä–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (`lo`) –Ω–∞—Å –Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç. –ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç `IP-–∞–¥—Ä–µ—Å` –≤—Ç–æ—Ä–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (`172.17.0.2`).

- –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç—É:

```bash
ping -c 2 google.com
```

–§–ª–∞–≥ `-c 2` –æ–∑–Ω–∞—á–∞–µ—Ç 2 –ø–æ–ø—ã—Ç–∫–∏ [`ping`](https://ru.wikipedia.org/wiki/Ping).

- –û–±—Ä–∞—Ç–∏–º—Å—è –∫–æ –≤—Ç–æ—Ä–æ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É. –°–Ω–∞—á–∞–ª–∞ –ø–æ `IP-–∞–¥—Ä–µ—Å—É`:

```bash
ping -c 2 172.17.0.3
```

–†–∞–±–æ—Ç–∞–µ—Ç. –¢–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
ping -c 2 alpine2
```

–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ —É–¥–∞–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker container stop alpine1 alpine2
docker container rm alpine1 alpine2
```

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è —Å–µ—Ç—å `bridge` –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω–µ.

__–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π —Å–µ—Ç–∏ `bridge`__

–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã —Å–Ω–æ–≤–∞ —Å–æ–∑–¥–∞–µ–º 2 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `alpine`, –Ω–æ –ø–æ–¥–∫–ª—é—á–∞–µ–º –∏—Ö –∫ –∫–∞—Å—Ç–æ–º–Ω–æ–π —Å–µ—Ç–∏ `alpine-net`. –≠—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π —Å–µ—Ç–∏ `bridge`. –ó–∞—Ç–µ–º –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º —Ç—Ä–µ—Ç–∏–π `alpine`, –ø–æ–¥–∫–ª—é—á–∞–µ–º—ã–π –∫ `bridge`, –Ω–æ –Ω–µ –∫ `alpine-net`, –∏ —á–µ—Ç–≤–µ—Ä—Ç—ã–π `alpine`, –ø–æ–¥–∫–ª—é—á–∞–µ–º—ã–π –∫ –æ–±–µ–∏–º —Å–µ—Ç—è–º.

- –°–æ–∑–¥–∞–µ–º —Å–µ—Ç—å `alpine-net`. –§–ª–∞–≥ `--driver bridge` –º–æ–∂–Ω–æ –æ–ø—É—Å—Ç–∏—Ç—å, –ø–æ—Å–∫–æ–ª—å–∫—É `bridge` —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ç—å—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

```bash
docker network create --driver bridge alpine-net
```

- –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π:

```bash
docker network ls
```

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–µ—Ç—å `alpine-net`:

```bash
docker network inspect alpine-net
```

–ü–æ–ª—É—á–∞–µ–º `IP-–∞–¥—Ä–µ—Å` —Å–µ—Ç–∏ –∏ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_ –Ω–∞ [—Å–µ—Ç–µ–≤–æ–π —à–ª—é–∑](https://ru.wikipedia.org/wiki/%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D1%88%D0%BB%D1%8E%D0%B7), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —à–ª—é–∑–∞ `bridge`.

- –°–æ–∑–¥–∞–µ–º 4 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. _–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_ –Ω–∞ —Ñ–ª–∞–≥ `--network`. –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `docker run` –º—ã –º–æ–∂–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–æ–ª—å–∫–æ –∫ –æ–¥–Ω–æ–π —Å–µ—Ç–∏, –ø–æ—ç—Ç–æ–º—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ `alpine4` –∫ `alpine-net` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ:

```bash
docker run -dit --name alpine1 --network alpine-net alpine ash

docker run -dit --name alpine2 --network alpine-net alpine ash

docker run -dit --name alpine3 alpine ash

docker run -dit --name alpine4 alpine ash
# !
docker network connect alpine-net alpine4
```

–ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
docker ps
```

- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º `bridge` –∏ `alpine-net`:

```bash
docker network inspect bridge
```

–í–∏–¥–∏–º, —á—Ç–æ –∫ –¥–∞–Ω–Ω–æ–π —Å–µ—Ç–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã `apline3` –∏ `alpine4`.

```bash
docker network inspect alpine-net
```

–ê –∫ —ç—Ç–æ–π —Å–µ—Ç–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã `alpine1`, `alpine2` –∏ `alpine4`.

- –í –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–µ—Ç—è—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –º–æ–≥—É—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ `IP-–∞–¥—Ä–µ—Å–∞–º`, –Ω–æ —Ç–∞–∫–∂–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º. –î–∞–Ω–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ–º —Å–µ—Ä–≤–∏—Å–∞ (automatic service discovery). –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ `alpine1`:

```bash
docker container attach alpine1

ping -c 2 alpine2
# success

ping -c 2 alpine 4
# success

ping -c 2 alpine1
# success
```

- –ü—Ä–æ–±—É–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ `alpine3`:

```bash
ping -c 2 alpine3
# failure
```

- –û—Ç–∫–ª—é—á–∞–µ–º—Å—è –æ—Ç `alpine1` –∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ `alpine4`:

```bash
docker container attach alpine4

ping -c 2 alpine1
# success

ping -c 2 alpine2
# success

ping -c 2 alpine3
# failure
# –Ω–æ
ping -c 2 172.17.0.2 # IP-–∞–¥—Ä–µ—Å alpine3
# success

ping -c 2 alpine4
# success
```

- –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç—É:

```bash
ping -c 2 google.com
# success
```

- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ —É–¥–∞–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ —Å–µ—Ç—å `alpine-net`:

```bash
docker container stop alpine1 alpine2 alpine3 alpine4

docker container rm alpine1 alpine2 alpine3 alpine4

docker network rm alpine-net
```

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–∞—Ä–æ—á–∫—É –ø—Ä–∏–º–µ—Ä–æ–≤ `Dockerfile` –¥–ª—è `Node.js-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π`.

_–ü—Ä–∏–º–µ—Ä —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞ `Node.js`_

```bash
FROM node:16

# —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
WORKDIR /usr/src/app

# —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
# —Å–∏–º–≤–æ–ª –∞—Å—Ç–µ—Ä–∏—Å–∫ ("*") –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
# —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±–∞ —Ñ–∞–π–ª–∞: `package.json` –∏ `package-lock.json`
COPY package*.json ./

RUN npm install
# –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–±–æ—Ä–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω
# RUN npm ci --only=production

# –∫–æ–ø–∏—Ä—É–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
COPY . .

EXPOSE 4000
CMD [ "node", "server.js" ]
```

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `COPY package*.json ./` –∏ `COPY . .` –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ü–µ–ª—è—Ö –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—ã–≥–æ–¥—ã –∏–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–æ–µ–≤. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —Ç–∞–∫ —á–∞—Å—Ç–æ, –∫–∞–∫ —Ñ–∞–π–ª—ã, –Ω–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏—Ö –ø—Ä–∏ –∫–∞–∂–¥–æ–π —Å–±–æ—Ä–∫–µ –æ–±—Ä–∞–∑–∞.

_–ü—Ä–∏–º–µ—Ä –∏–∑ —Å—Ç–∞—Ç—å–∏ ["10 –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –ø–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ Node.js-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é Docker"](https://snyk.io/blog/10-best-practices-to-containerize-nodejs-web-applications-with-docker/)_

–ü—Ä–∏–º–µ—Ä —è–≤–ª—è–µ—Ç—Å—è —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–º –∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞.

```bash
FROM node:lts-alpine@sha256:b2da3316acdc2bec442190a1fe10dc094e7ba4121d029cb32075ff59bb27390a
RUN apk add dumb-init
ENV NODE_ENV production
WORKDIR /usr/src/app
COPY --chown=node:node . .
RUN npm ci --only=production
USER node
CMD ['dumb-init', 'node', 'server.js']
```

- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è `Node.js`](https://docs.docker.com/language/nodejs/)
- [–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è `Node.js`](https://github.com/nodejs/docker-node/blob/main/docs/BestPractices.md)

## Docker Compose

`Docker Compose` - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞ `Docker-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π`, —Å–æ—Å—Ç–æ—è—â–∏—Ö –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∞–π–ª `docker-compose.yml`.

–ü—Ä–æ—Ü–µ—Å—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `Compose`, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 3 —ç—Ç–∞–ø–æ–≤:

- –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é `Dockerfile`;
- –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ—Å—Ç–æ–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤ `docker-compose.yml` (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ);
- –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã `docker compose up` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ `docker-compose.yml`:

```yml
version: "3.9"  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
services:
 web:
   build: .
   ports:
     - "5000:5000"
   volumes:
     - .:/code
     - logvolume:/var/log
   links:
     - redis
 redis:
   image: redis
volumes:
 logvolume: {}
```

`Compose` –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:

- –∑–∞–ø—É—Å–∫–∞—Ç—å, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã;
- –ø–æ–ª—É—á–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤;
- –ø–æ–ª—É—á–∞—Ç—å –ª–æ–≥–∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤;
- –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö.

`Compose` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥ –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ;
- —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–º–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤;
- –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤;
- –ø–µ—Ä–µ–¥–∞—á–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –ø—Ä–æ–¥–∞–∫—à–Ω–∞ –∏ —Ç.–¥.).

[–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å Docker Compose](https://docs.docker.com/compose/).

### `docker compose`

–ö–æ–º–∞–Ω–¥–∞ `docker compose` —è–≤–ª—è–µ—Ç—Å—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ–π `docker-compose CLI` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è `Compose`.

```bash
# —Å–∏–≥–Ω–∞—Ç—É—Ä–∞
docker-compose [-f <arg>...] [--profile <name>...] [options] [COMMAND] [ARGS...]

# –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–∞–≥–∏
-f - –ø—É—Ç—å –∫ docker-compose.yml
-p - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
--project-path - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–±–æ—á–µ–π —è–≤–ª—è–µ—Ç—Å—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è docker-compose.yml)

# –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
up - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
down - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, —Å–µ—Ç–µ–π, –æ–±—Ä–∞–∑–æ–≤ –∏ —Ç–æ–º–æ–≤
start - –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
stop - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
restart - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
create - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
rm - —É–¥–∞–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
run - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã
exec - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
```

[–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ñ–ª–∞–≥–æ–≤ –∏ –∫–æ–º–∞–Ω–¥](https://docs.docker.com/compose/reference/).

### docker-compose.yml

–§–∞–π–ª `Compose` - —ç—Ç–æ —Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YAML`, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π —Å–µ—Ä–≤–∏—Å—ã, —Å–µ—Ç–∏ –∏ —Ç–æ–º–∞. –î–µ—Ñ–æ–ª—Ç–Ω—ã–º –ø—É—Ç–µ–º —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ —è–≤–ª—è–µ—Ç—Å—è `./docker-compose.yml`.

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —É—Å—Ç–∞–Ω–æ–≤–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É, –∑–∞–ø—É—â–µ–Ω–Ω–æ–º—É –¥–ª—è —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞. –≠—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `docker run`. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ—Ç–∏ –∏ —Ç–æ–º–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∫–æ–º–∞–Ω–¥ `docker network create` –∏ `docker volume create`.

–ù–∞—Å—Ç—Ä–æ–π–∫–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ `Dockerfile`, —Ç–∞–∫–∏–µ –∫–∞–∫ `CMD`, `EXPOSE`, `VOLUME` –∏ `ENV` –Ω–µ –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤ `docker-compose.yml`.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤.

_build_

–ù–∞—Å—Ç—Ä–æ–π–∫–∏, –ø—Ä–∏–º–µ–Ω—è–µ–º—ã–µ –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏.

`build` –º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏ - –ø—É—Ç–∏ –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —Å–±–æ—Ä–∫–∏:

```yml
version: "3.9"
services:
 webapp:
   build: ./dir
```

–ò–ª–∏ –≤ –≤–∏–¥–µ –æ–±—ä–µ–∫—Ç–∞, –≥–¥–µ `context` - –ø—É—Ç—å –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, `dockerfile` - –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π `Dockerfile` –∏ `args` - –∞—Ä–≥—É–º–µ–Ω—Ç—ã:

```yml
version: "3.9"
services:
 webapp:
   build:
     context: ./dir
     dockerfile: Dockerfile-alternate
     args:
       buildno: 1
```

–í —Å–ª—É—á–∞–µ —Å `args` –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `Dockerfile`:

```yml
# syntax=docker/dockerfile:1

ARG buildno
ARG gitcommithash

RUN echo "–ù–æ–º–µ—Ä —Å–±–æ—Ä–∫–∏: $buildno"
RUN echo "–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –∫–æ–º–º–∏—Ç–µ: $gitcommithash"
```

```yml
build:
 context: .
 args:
   buildno: 1
   gitcommithash: cdc3b19
   # or
   - buildno=1
   - gitcommithash=cdc3b19
```

_network_

–°–µ—Ç—å, –∫ –∫–æ—Ç–æ—Ä–æ–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏ (–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `RUN`):

```yml
build:
 context: .
 network: host
# or
build:
 context: .
 network: custom_network_1
```

_command_

–ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã:

```yml
command: bundle exec thin -p 3000
```

_depends\_on_

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

- `docker compose up` –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –í –ø—Ä–∏–º–µ—Ä–µ –Ω–∏–∂–µ `db` –∏ `redis` –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–µ—Ä–µ–¥ `web`;
- `docker compose up SERVICE` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `SERVICE`. –í –ø—Ä–∏–º–µ—Ä–µ `docker compose up web` —Ç–∞–∫–∂–µ —Å–æ–∑–¥–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç `db` –∏ `redis`;
- `docker compose stop` –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –í –ø—Ä–∏–º–µ—Ä–µ `web` –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ `db` –∏ `redis`.

```yml
version: "3.9"
services:
 web:
   build: .
   depends_on:
     - db
     - redis
   redis:
     image: redis
   db:
     image: postgres
```

_restart\_policy_

–ü–æ–ª–∏—Ç–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –∏ –∫–æ–≥–¥–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è:

- `condition`: —É—Å–ª–æ–≤–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ - `none`, `on-failure` –∏–ª–∏ `any` (–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é);
- `delay`: –≤—Ä–µ–º—è –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–Ω—è–µ—Ç—Å—è `5s`);
- `max_attempts`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ);
- `window`: –≤—Ä–µ–º—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ).

```yml
version: "3.9"
services:
 redis:
   image: redis:alpine
   deploy:
     restart_policy:
       condition: on-failure
       delay: 5s
       max_attempts: 3
       window: 120s
```

_entrypoint_

–ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞:

```yml
entrypoint: /code/entrypoint.sh
```

_env\_file_

–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞. –ú–æ–∂–µ—Ç –±—ã—Ç—å –µ–¥–∏–Ω–∏—á–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–ª–∏ —Å–ø–∏—Å–∫–æ–º.

–ï—Å–ª–∏ —Ñ–∞–π–ª `Compose` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω —Å –ø–æ–º–æ—â—å—é `docker compose -f FILE`, –ø—É—Ç–∏ –≤ `env_file` –±—É–¥—É—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —ç—Ç–æ—Ç —Ñ–∞–π–ª.

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ —Ä–∞–∑–¥–µ–ª–µ `environment`, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è.

```yml
env_file: .env
# or
env_file:
 - ./common.env
 - ./apps/web.env
 - /opt/runtime_opts.env
```

_expose_

–í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ –±–µ–∑ –∏—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ —Ö–æ—Å—Ç–µ - –ø–æ—Ä—Ç—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º (linked) —Å–µ—Ä–≤–∏—Å–∞–º. –ú–æ–≥—É—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–æ—Ä—Ç—ã:

```yml
expose:
 - "3000"
 - "8000"
```

_external\_links_

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É, –∑–∞–ø—É—â–µ–Ω–Ω–æ–º—É –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ `docker-compose.yml` –∏–ª–∏ –¥–∞–∂–µ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ `Compose`. –û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏—Ö –æ–±—â–∏–µ –∏–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:

```yml
external_links:
 - redis_1
 - project_db_1:mysql
 - project_db_1:postgresql
```

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: –≤–Ω–µ—à–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω—ã —Ö–æ—Ç—è –±—ã –∫ –æ–¥–Ω–æ–π —Å–µ—Ç–∏, –∫ –∫–æ—Ç–æ—Ä–æ–π –ø–æ–¥–∫–ª—é—á–µ–Ω —Å–µ—Ä–≤–∏—Å.

_image_

–û–±—Ä–∞–∑ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º/—Ç–µ–≥–æ–º –∏–ª–∏ —á–∞—Å—Ç–∏—á–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º (partial identifier):

```yml
image: redis
image: node:16
image: example-registry.com:4000/postgresql
```

_links_

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫ –¥—Ä—É–≥–æ–º—É —Å–µ—Ä–≤–∏—Å—É. –ü–æ–¥–∫–ª—é—á–∞–µ–º—ã–π —Å–µ—Ä–≤–∏—Å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –Ω–∞–∑–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ –∏ —Å–∏–Ω–æ–Ω–∏–º–∞ —Å—Å—ã–ª–∫–∏ (link alias) (`"SERVICE:ALIAS"`) –∏–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏—è:

```yml
web:
 links:
   - "db"
   - "db:database"
   - "redis"
```

_network\_mode_

–°–µ—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º:

```yml
network_mode: "bridge"
network_mode: "host"
network_mode: "none"
```

_networks_

–°–µ—Ç–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```yml
services:
 some-service:
   networks:
    - some-network
    - other-network
```

_ports_

–í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤.

–ö–æ—Ä–æ—Ç–∫–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:

- –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –æ–±–∞ –ø–æ—Ä—Ç–∞ (`HOST:CONTAINER`);
- –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–¥–ª—è —Ö–æ—Å—Ç–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —ç—Ñ–µ–º–µ—Ä–Ω—ã–π –ø–æ—Ä—Ç);
- –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å `IP-–∞–¥—Ä–µ—Å` —Ö–æ—Å—Ç–∞ –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ (bind) –∏ –æ–±–∞ –ø–æ—Ä—Ç–∞ (–∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —è–≤–ª—è–µ—Ç—Å—è `0.0.0.0`, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã) (`IPADDR:HOSTPORT:CONTAINERPORT`).

```yml
ports:
 - "3000"
 - "8000:8000"
 - "9090-9091:8080-8081"
 - "127.0.0.1:8001:8001"
 - "127.0.0.1::5000"
 - "6060:6060/udp"
```

–î–ª–∏–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

- `target`: –ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞;
- `published`: –ø–æ—Ä—Ç —Ö–æ—Å—Ç–∞ (–¥–æ—Å—Ç—É–ø–Ω—ã–π –ø—É–±–ª–∏—á–Ω–æ);
- `protocol`: –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ—Ä—Ç–∞ (`tcp` –∏–ª–∏ `udp`);
- `mode`: `host` | `ingress`.

_restart_

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞. –ó–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —è–≤–ª—è–µ—Ç—Å—è `no`, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞. `always` –æ–∑–Ω–∞—á–∞–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ. `on-failure` –æ–∑–Ω–∞—á–∞–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –∞–≤–∞—Ä–∏–π–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. `unless-stopped` –æ–∑–Ω–∞—á–∞–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤–æ –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤, –∫—Ä–æ–º–µ –ø—Ä–µ–¥–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:

```yml
restart: "no"
restart: always
restart: on-failure
restart: unless-stopped
```

__volumes__

–ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ–π —Ö–æ—Å—Ç–∞ (host paths) –∏–ª–∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–º–æ–≤ (named volumes), –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–µ—Ä–≤–∏—Å–∞.

–ü—É—Ç–∏ —Ö–æ—Å—Ç–∞ –º–æ–≥—É—Ç –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ —á–∞—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞. –ò—Ö –Ω–µ –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –≤ –∫–ª—é—á–µ `volume` –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ.

–û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã —Ç–æ–º–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏, –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤ —Ç–∞–∫–æ–º `volume`.

–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–º `mydata` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä–≤–∏—Å–æ–º `web`, –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è `bind mount` (–ø–µ—Ä–≤—ã–π –ø—É—Ç—å –≤ `volumes` —Å–µ—Ä–≤–∏—Å–∞ `db`). `db` —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–º `dbdata` (–≤—Ç–æ—Ä–æ–π –ø—É—Ç—å), –Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –µ–≥–æ —Å –ø–æ–º–æ—â—å—é —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–º–æ–≤. –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–º–∞ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –∫–ª—é—á–µ `volume` –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è:

```yml
version: "3.9"
services:
 web:
   image: nginx:alpine
   volumes:
     - type: volume
       source: mydata
       target: /data
       volume:
         nocopy: true
     - type: bind
       source: ./static
       target: /opt/app/static

 db:
   image: postgres:latest
   volumes:
     - "/var/run/postgres/postgres.sock:/var/run/postgres/postgres.sock"
     - "dbdata:/var/lib/postgresql/data"

volumes:
 mydata:
 dbdata:
```

_–ö–æ—Ä–æ—Ç–∫–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å_

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç `[SOURCE:]TARGET[:MODE]`, –≥–¥–µ `SOURCE` - —ç—Ç–æ –ø—É—Ç—å —Ö–æ—Å—Ç–∞ –∏–ª–∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–º, `TARGET` - —ç—Ç–æ –ø—É—Ç—å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–º–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏ `MODE` - `ro` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ `rw` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ (–¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ).

–î–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ (–ø—É—Ç—å –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è, –Ω–∞—á–∏–Ω–∞—è —Å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å —Ñ–∞–π–ª–æ–º `Compose`). –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –¥–æ–ª–∂–Ω—ã –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `.` –∏–ª–∏ `..`.

```yml
volumes:
 # –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø—É—Ç—å –∏ –¥–µ–ª–µ–≥–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–º–∞ –¥–≤–∏–∂–∫—É
 - /var/lib/mysql

 # –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ (mapping) –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π
 - /opt/data:/var/lib/mysql

 # –ø—É—Ç—å —Ö–æ—Å—Ç–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å —Ñ–∞–π–ª–æ–º `Compose`
 - ./cache:/tmp/cache

 # –ø—É—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 - ~/configs:/etc/configs/:ro

 # –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–º
 - datavolume:/var/lib/mysql
```

_–î–ª–∏–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å_

–î–ª–∏–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

- `type`: —Ç–∏–ø –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - `volume`, `bind`, `tmpfs` –∏–ª–∏ `npipe`;
- `source`: –∏—Å—Ç–æ—á–Ω–∏–∫ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—É—Ç—å —Ö–æ—Å—Ç–∞ –¥–ª—è `bind mount` –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–º–∞, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤ –≤–µ—Ä—Ö–Ω–µ—É—Ä–æ–≤–Ω–µ–≤–æ–º `volumes`;
- `target`: –ø—É—Ç—å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–º–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ;
- `read_only`: –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–æ–º–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è;
- `bind`: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è:
 - `propagation`: —Ä–µ–∂–∏–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è;
- `volume`: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–æ–º–∞:
 - `nocopy`: –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–ø—Ä–µ—Ç–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–æ–º–∞.

```yml
version: "3.9"
services:
 web:
   image: nginx:alpine
   ports:
     - "80:80"
   volumes:
     - type: volume
       source: mydata
       target: /data
       volume:
         nocopy: true
     - type: bind
       source: ./static
       target: /opt/app/static

networks:
 webnet:

volumes:
 mydata:
```

_–î—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –∫–æ–º–∞–Ω–¥—ã `docker run`_

```yml
user: postgres
working_dir: /code

domainname: foo.com
hostname: foo
ipc: host
mac_address: 02:42:ac:11:65:43

privileged: true

read_only: true
shm_size: 64M
stdin_open: true
tty: true
```

_–ü—Ä–∏–º–µ—Ä—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏_

```bash
2.5s
10s
1m30s
2h32m
5h34m56s
```

_–ü—Ä–∏–º–µ—Ä—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–∞–π—Ç–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π_

```bash
2b
1024kb
2048k
300m
1gb
```

__–ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö__

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è. `Compose` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `docker compose`. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —Ç–µ—Ä–º–∏–Ω–∞–ª —Å–æ–¥–µ—Ä–∂–∏—Ç `POSTGRES_VERSION=9.3` –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–∞–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:

```yml
db:
 image: "postgres:${POSTGRES_VERSION}"
```

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `docker compose` –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `POSTGRES_VERSION` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `9.3` –∏ –º—ã –ø–æ–ª—É—á–∞–µ–º `postgres:9.3`.

–ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π –∏ –º—ã –ø–æ–ª—É—á–∞–µ–º `postgres:`.

–î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ —Ñ–∞–π–ª–µ `.env`, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —á—Ç–æ –∏ —Ñ–∞–π–ª `Compose`. –ó–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ `.env`.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞: `$VAR` –∏ `${VAR}`. –í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–∫–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–∞–∫:

- –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
 - `${VAR:-default}`: –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ `default`, –∫–æ–≥–¥–∞ `VAR` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–ª–∏ —è–≤–ª—è–µ—Ç—Å—è –ø—É—Å—Ç–æ–π;
 - `${VAR-default}`: –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ `default` —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ `VAR` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞;
- –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:
 - `${VAR:?error}`: –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –µ—Å–ª–∏ `VAR` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–ª–∏ —è–≤–ª—è–µ—Ç—Å—è –ø—É—Å—Ç–æ–π;
 - `${VAR?error}`: –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `VAR` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.

–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∏–ø–∞ `${VAR/foo/bar}` –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.

[–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–∞–π–ª–∞ `Compose` –≤–µ—Ä—Å–∏–∏ 3](https://docs.docker.com/compose/compose-file/compose-file-v3).

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –≤—ã —Ö–æ—Ç—è –±—ã –≤–∫—Ä–∞—Ç—Ü–µ –æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å —Å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —á–∞—Å—Ç–µ–π –∏–ª–∏ –∏–∑—É—á–∞–ª–∏ –¥—Ä—É–≥–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –ø–æ—Å–≤—è—â–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç–µ —Å [`Docker`](https://www.docker.com/). –í–ø—Ä–æ—á–µ–º, –≤ —ç—Ç–æ–π —á–∞—Å—Ç–∏ `Docker` –±—É–¥–µ—Ç —Å–æ–≤—Å–µ–º —á—É—Ç—å-—á—É—Ç—å.

–¢–∞–∫–∂–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –Ω–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω [`Docker`](https://www.docker.com/products/docker-desktop) –∏ [`Node.js`](https://nodejs.org/en/download/).

–•–æ—Ä–æ—à–æ, –µ—Å–ª–∏ –Ω–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω [`Yarn`](https://yarnpkg.com/) –∏ –≤—ã –∏–º–µ–µ—Ç–µ –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å [`React`](https://ru.reactjs.org/), [`Vue`](https://vuejs.org/), `Node.js`, [`PostgreSQL`](https://www.postgresql.org/) –∏ [sh](https://pubs.opengroup.org/onlinepubs/009604599/utilities/sh.html) –∏–ª–∏ [`bash`](http://www.gnu.org/software/bash/) (–≤—Å–µ —ç—Ç–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

–ö–∞–∫ —è —Å–∫–∞–∑–∞–ª, –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ —Ç—Ä–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

- –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ `React.js`;
- –∞–¥–º–∏–Ω–∫–∏ –Ω–∞ `Vue.js`;
- —Å–µ—Ä–≤–µ—Ä–∞ (API) –Ω–∞ `Node.js`.

–í –∫–∞—á–µ—Å—Ç–≤–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `PostgreSQL`, –∞ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –Ω–µ–π - [Prisma](https://www.prisma.io/).

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º:

- –≤ –∞–¥–º–∏–Ω–∫–µ –∑–∞–¥–∞—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, —Ç–µ–º—ã –∏ –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞;
- —ç—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ë–î –∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ;
- –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ "—Ç—É–¥—É—à–∫–∞";
- –∑–∞–¥–∞—á–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ë–î;
- –≤—Å–µ —ç—Ç–æ –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º.

–°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–µ–µ –∏ —Å–æ–∑–¥–∞–µ–º –µ—â–µ –ø–∞—Ä–æ—á–∫—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:

```bash
mkdir docker-test

cd !$ # docker-test

mkdir services sh uploads
```

–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `services` –±—É–¥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞—à–∏ —Å–µ—Ä–≤–∏—Å—ã, –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `sh` - —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞, –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `uploads` –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ –±—É–¥–µ–º, –Ω–æ –æ–±—ã—á–Ω–æ –≤ –Ω–µ–π —Ö—Ä–∞–Ω—è—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã, –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –∞–¥–º–∏–Ω–æ–º –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `services`, —Å–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è API, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —à–∞–±–ª–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞ —Å –ø–æ–º–æ—â—å—é [`Create React App`](https://create-react-app.dev/) –∏ —à–∞–±–ª–æ–Ω –∞–¥–º–∏–Ω–∫–∏ —Å –ø–æ–º–æ—â—å—é [`Vue CLI`](https://cli.vuejs.org/):

```bash
cd services

mkdir api

yarn create react-app client
# or
npx create-react-app client

yarn create vue-app admin
# or
npx vue create admin
```

–ù–∞—á–Ω–µ–º —Å API.

### API

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `api`, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º `Node.js-–ø—Ä–æ–µ–∫—Ç` –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
cd api

yarn init -yp
# or
npm init -y

# –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
yarn add express cors
# –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
yarn add -D nodemon prisma
```

- [express](https://www.npmjs.com/package/express) - `Node.js-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫` –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤;
- [cors](https://www.npmjs.com/package/cors) - —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å [CORS](https://developer.mozilla.org/ru/docs/Web/HTTP/CORS);
- [nodemon](https://www.npmjs.com/package/nodemon) - —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏;
- [prisma](https://www.npmjs.com/package/prisma) - —è–¥—Ä–æ (core) [ORM](https://ru.wikipedia.org/wiki/ORM), –∫–æ—Ç–æ—Ä–æ–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å `postgres`.

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º `prisma`:

```bash
npx prisma init
```

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `prisma`, –∞ —Ç–∞–∫–∂–µ —Ñ–∞–π–ª–æ–≤ `prisma/schema.prisma` –∏ `.env`.

–û–ø—Ä–µ–¥–µ–ª—è–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–∏ –≤ —Ñ–∞–π–ª–µ `prisma/schema.prisma`:

```js
// https://pris.ly/d/prisma-schema
generator client {
  provider      = "prisma-client-js"
  // —ç—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
  binaryTargets = ["native"]
}

datasource db {
  provider = "postgresql"
  // –ø—É—Ç—å –∫ –ë–î –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è `DATABASE_URL`
  url      = env("DATABASE_URL")
}

// –º–æ–¥–µ–ª—å –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
model Settings {
  id             Int      @id @default(autoincrement())
  created_at     DateTime @default(now())
  updated_at     DateTime @updatedAt
  greetings      String
  theme          String
  base_font_size String
}

// –º–æ–¥–µ–ª—å –¥–ª—è –∑–∞–¥–∞—á–∏
model Todo {
  id         Int      @id @default(autoincrement())
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  text       String
  done       Boolean
}
```

–û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ –ë–î –≤ —Ñ–∞–π–ª–µ `.env`:

```
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/mydb?schema=public
```

–ó–¥–µ—Å—å:

- `postgres` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å;
- `localhost` - —Ö–æ—Å—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –∑–∞–ø—É—â–µ–Ω —Å–µ—Ä–≤–µ—Ä `postgres`;
- `5432` - –ø–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –∑–∞–ø—É—â–µ–Ω —Å–µ—Ä–≤–µ—Ä `postgres`;
- `mydb` - –Ω–∞–∑–≤–∞–Ω–∏–µ –ë–î.

–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ [–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `postgres`](https://hub.docker.com/_/postgres) –≤ —Ñ–∞–π–ª–µ `sh/db` (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è):

```bash
docker run --rm --name postgres -e POSTGRES_PASSWORD=postgres -e POSTGRES_USER=postgres -e POSTGRES_DB=mydb -dp 5432:5432 -v $HOME/docker/volumes/postgres:/var/lib/postgresql/data postgres
```

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: –µ—Å–ª–∏ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –Ω–∞ `Mac`, –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å–∞–º–æ–º—É —Å–µ–±–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ñ–∞–π–ª–∞ `sh/db`. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫:

```bash
# –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `sh`
chmod +x db
# or
sudo chmod +x db
```

–ù–∞—Ö–æ–¥—è—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞, –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É:

```bash
sh/db
```

–ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞–∑–∞ `postgres` –∏–∑ [`Docker Hub`](https://hub.docker.com/) –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º `postgres`.

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: –∏–Ω–æ–≥–¥–∞ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –æ—à–∏–±–∫–∞, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å —Ç–µ–º, —á—Ç–æ –ø–æ—Ä—Ç 5432 –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ `PID` –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ "—É–±–∏—Ç—å" –µ–≥–æ. –ù–∞ `Mac` —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Ç–∞–∫:

```bash
# –ø–æ–ª—É—á–∞–µ–º `PID` –ø—Ä–æ—Ü–µ—Å—Å–∞, –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –Ω–∞ –ø–æ—Ä—Ç—É `5432`
sudo lsof -i :5432
# –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ `PID` –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `103`
# "—É–±–∏–≤–∞–µ–º" –ø—Ä–æ—Ü–µ—Å—Å
sudo kill 103
```

–£–±–µ–¥–∏—Ç—å—Å—è –≤ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –º–æ–∂–Ω–æ, –≤—ã–ø–æ–ª–Ω–∏–≤ –∫–æ–º–∞–Ω–¥—É `docker ps`:

<img src="https://habrastorage.org/webt/qz/cb/jn/qzcbjnikl7acjtp3u90sd1xcf2o.png" alt="" />
<br />

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏–≤ [`Docker Desktop`](https://www.docker.com/products/docker-desktop):

<img src="https://habrastorage.org/webt/xr/zu/n9/xrzun9hxa_zlwwvueumwjzyzq98.png" alt="" />
<br />

–ò–ª–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ `Individual Containers` [—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è `Docker` –¥–ª—è `VSCode`](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker):

<img src="https://habrastorage.org/webt/1l/e0/96/1le096w7kcbze_0outprie0ua1g.png" alt="" />
<br />

–í—ã–ø–æ–ª–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é:

```bash
# –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `api`
# migrate dev - –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
# --name init - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
npx prisma migrate dev --name init
```

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞ `prisma/migrations/[Date]-init/migration.sql`, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é –∫ –ë–î, —Å–æ–∑–¥–∞–Ω–∏—é –≤ –Ω–µ–π —Ç–∞–±–ª–∏—Ü, —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ [`@prisma/client`](https://www.npmjs.com/package/@prisma/client).

–°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª `prisma/seed.js` —Å –∫–æ–¥–æ–º –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

```js
import Prisma from '@prisma/client'
const { PrismaClient } = Prisma

// –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–ª–∏–µ–Ω—Ç–∞
const prisma = new PrismaClient()

// –Ω–∞—á–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
const initialSettings = {
  greetings: 'Welcome to Docker Test App',
  theme: 'light',
  base_font_size: '16px'
}

// –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏
const initialTodos = [
  {
    text: 'Eat',
    done: true
  },
  {
    text: 'Code',
    done: true
  },
  {
    text: 'Sleep',
    done: false
  },
  {
    text: 'Repeat',
    done: false
  }
]

async function main() {
  try {
    // –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —è–≤–ª—è–µ—Ç—Å—è –ø—É—Å—Ç–æ–π
    if (!(await prisma.settings.findFirst())) {
      await prisma.settings.create({ data: initialSettings })
    }
    // –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –∑–∞–¥–∞—á —è–≤–ª—è–µ—Ç—Å—è –ø—É—Å—Ç–æ–π
    if (!(await (await prisma.todo.findMany()).length)) {
      await prisma.todo.createMany({ data: initialTodos })
    }
    console.log('Database has been successfully seeded üöÄ ')
  } catch (e) {
    console.log(e)
  } finally {
    await prisma.$disconnect()
  }
}

main()
```

–í `package.json` –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∫–æ–¥–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–º–æ–¥—É–ª—å), –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ä–µ–∂–∏–º–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ, –∞ —Ç–∞–∫–∂–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

```json
"type": "module",
"scripts": {
  "dev": "nodemon",
  "start": "prisma generate && prisma migrate deploy && node index.js"
},
"prisma": {
  "seed": "node prisma/seed.js"
}
```

–ó–∞–ø–æ–ª–Ω—è–µ–º –ë–î –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

```bash
# –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `api`
npx prisma db seed
```

–û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–∞—à—É –ë–î –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ:

```bash
npx prisma studio
```

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—Ç–∫—Ä—ã—Ç–∏—é –≤–∫–ª–∞–¥–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:5555`:

<img src="https://habrastorage.org/webt/6-/ar/y1/6-ary1tso3uyjb0imkqlwg4aw94.png" alt="" />
<br />

–ü—Ä–∏—Å—Ç—É–ø–∞–µ–º –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å–µ—Ä–≤–µ—Ä–∞.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π:

```
- routes
  - index.js
  - settings.routes.js - –º–∞—Ä—à—Ä—É—Ç—ã (—Ä–æ—É—Ç—ã) –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
  - todo.routes.js - —Ä–æ—É—Ç—ã –¥–ª—è –∑–∞–¥–∞—á
- index.js
```

–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `index.js`:

```js
// –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã
import express from 'express'
import cors from 'cors'
import Prisma from '@prisma/client'
import apiRoutes from './routes/index.js'
import { join, dirname } from 'path'
import { fileURLToPath } from 'url'
const { PrismaClient } = Prisma

// —Å–æ–∑–¥–∞–µ–º –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä `prisma`
export const prisma = new PrismaClient()

// –ø—É—Ç—å –∫ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
const __dirname = dirname(fileURLToPath(import.meta.url))

// —Å–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è `express`
const app = express()

// –æ—Ç–∫–ª—é—á–∞–µ–º `cors`
app.use(cors())
// –≤–∫–ª—é—á–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ `json` –≤ –æ–±—ä–µ–∫—Ç—ã
app.use(express.json())

// —ç—Ç–æ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –Ω–∞–º –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ
if (process.env.ENV === 'prod') {
  // –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø—É—Ç–∏
  // –ø—É—Ç—å –∫ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ + `client/build`
  const clientBuildPath = join(__dirname, 'client', 'build')
  // –ø—É—Ç—å –∫ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ + `admin/dist`
  const adminDistPath = join(__dirname, 'admin', 'dist')

  // –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
  // –∫–ª–∏–µ–Ω—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –ø—É—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
  app.use(express.static(clientBuildPath))
  app.use(express.static(adminDistPath))
  // –∞–¥–º–∏–Ω–∫–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –ø—É—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ + `/admin`
  app.use('/admin', (req, res) => {
    res.sendFile(join(adminDistPath, decodeURIComponent(req.url)))
  })
}
// —Ä–æ—É—Ç–∏–Ω–≥
app.use('/api', apiRoutes)

// –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
app.use((err, req, res, next) => {
  console.log(err)
  const status = err.status || 500
  const message = err.message || 'Something went wrong. Try again later'
  res.status(status).json({ message })
})

// –∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 5000
app.listen(5000, () => {
  console.log(`Server ready üöÄ `)
})
```

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–æ—É—Ç—ã.

–ù–∞—á–Ω–µ–º —Å —Ä–æ—É—Ç–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (`routes/index.js`):

```js
import { Router } from 'express'
import todoRoutes from './todo.routes.js'
import settingsRoutes from './settings.routes.js'

const router = Router()

router.use('/todo', todoRoutes)
router.use('/settings', settingsRoutes)

export default router
```

–†–æ—É—Ç–µ—Ä –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ (`routes/settings.routes.js`):

```js
import { Router } from 'express'
import { prisma } from '../index.js'

const router = Router()

// –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
router.get('/', async (req, res, next) => {
  try {
    const settings = await prisma.settings.findFirst()
    res.status(200).json(settings)
  } catch (e) {
    next(e)
  }
})

// –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
router.put('/:id', async (req, res, next) => {
  const id = Number(req.params.id)
  try {
    const settings = await prisma.settings.update({
      data: req.body,
      where: { id }
    })
    res.status(201).json(settings)
  } catch (e) {
    next(e)
  }
})

export default router
```

–†–æ—É—Ç–µ—Ä –¥–ª—è –∑–∞–¥–∞—á (`routes/todo.routes.js`):

```js
import { Router } from 'express'
import { prisma } from '../index.js'

const router = Router()

// –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á
router.get('/', async (req, res, next) => {
  try {
    const todos = (await prisma.todo.findMany()).sort(
      (a, b) => a.created_at - b.created_at
    )
    res.status(200).json(todos)
  } catch (e) {
    next(e)
  }
})

// —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
router.post('/', async (req, res, next) => {
  try {
    const newTodo = await prisma.todo.create({
      data: req.body
    })
    res.status(201).json(newTodo)
  } catch (e) {
    next(e)
  }
})

// –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
router.put('/:id', async (req, res, next) => {
  const id = Number(req.params.id)
  try {
    const updatedTodo = await prisma.todo.update({
      data: req.body,
      where: { id }
    })
    res.status(201).json(updatedTodo)
  } catch (e) {
    next(e)
  }
})

// —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
router.delete('/:id', async (req, res, next) => {
  const id = Number(req.params.id)
  try {
    await prisma.todo.delete({
      where: { id }
    })
    res.sendStatus(201)
  } catch (e) {
    next(e)
  }
})

export default router
```

–≠—Ç–æ –≤—Å–µ, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

### –ê–¥–º–∏–Ω–∫–∞

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–¥–º–∏–Ω–∫–∏ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π (`admin/src`):

```
- components
  - App.vue - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - Settings.vue - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
- index.js
```

–ù–∞—á–Ω–µ–º —Å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (`components/App.vue`).

–†–∞–∑–º–µ—Ç–∫–∞:

```js
<template>
  <div id="app">
    <h1>Admin</h1>
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
    <h2 v-if="loading">Loading...</h2>
    <!-- –û—à–∏–±–∫–∞ -->
    <h3 v-else-if="error" class="error">
      {{ error.message || 'Something went wrong. Try again later' }}
    </h3>
    <!-- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div v-else>
      <h2>Settings</h2>
      <!-- –ü—Ä–æ–ø—ã: –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–∏–∑ –ë–î), –º–µ—Ç–æ–¥ –¥–ª—è –∏—Ö –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –∞–¥—Ä–µ—Å API -->
      <Settings :settings="settings" :getSettings="getSettings" :apiUri="apiUri" />
    </div>
  </div>
</template>
```

–°—Ç–∏–ª–∏:

```css
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@200;400;600&display=swap');

:root {
  --primary: #0275d8;
  --success: #5cb85c;
  --warning: #f0ad4e;
  --danger: #d9534f;
  --light: #f7f7f7;
  --dark: #292b2c;
}

* {
  font-family: 'Montserrat', sans-serif;
  font-size: 1rem;
}

body.light {
  background-color: var(--light);
  color: var(--dark);
}

body.dark {
  background-color: var(--dark);
  color: var(--light);
}

#app {
  display: flex;
  flex-direction: column;
  text-align: center;
}

h2 {
  font-size: 1.4rem;
}

form div {
  display: flex;
  flex-direction: column;
  align-items: center;
}

label {
  margin: 0.5rem 0;
}

input {
  padding: 0.5rem;
  max-width: 220px;
  width: max-content;
  outline: none;
  border: 1px solid var(--dark);
  border-radius: 4px;
  text-align: center;
}

input:focus {
  border-color: var(--primary);
}

button {
  margin: 1rem 0;
  padding: 0.5rem 1rem;
  background: none;
  border: none;
  border-radius: 4px;
  outline: none;
  background-color: var(--success);
  color: var(--light);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
  cursor: pointer;
  user-select: none;
  transition: 0.2s;
}

button:active {
  box-shadow: none;
}

.error {
  color: var(--danger);
}
```

–°–∫—Ä–∏–ø—Ç:

```js
// –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
import Settings from './Settings'

export default {
  // –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  name: 'App',
  // –¥–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
  components: {
    Settings
  },
  // –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  data() {
    return {
      loading: true,
      error: null,
      settings: {},
      apiUri: 'http://localhost:5000/api/settings'
    }
  },
  // –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  created() {
    // –ø–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    this.getSettings()
  },
  // –º–µ—Ç–æ–¥—ã
  methods: {
    // –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
    async getSettings() {
      this.loading = true
      try {
        const response = await fetch(API_URI)
        if (!response.ok) throw response
        this.settings = await response.json()
      } catch (e) {
        this.error = e
      } finally {
        this.loading = false
      }
    }
  }
}
```

–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ (`components/Settings.vue`).

–†–∞–∑–º–µ—Ç–∫–∞:

```vue
<template>
  <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
  <div v-if="loading">Loading...</div>
  <!-- –û—à–∏–±–∫–∞ -->
  <div v-else-if="error">
    {{ error.message || JSON.stringify(error, null, 2) }}
  </div>
  <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
  <form v-else @submit.prevent="saveSettings">
    <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
    <div>
      <label for="greetings">Greetings</label>
      <input
        type="text"
        id="greetings"
        name="greetings"
        :value="settings.greetings"
        required
      />
    </div>
    <!-- –¢–µ–º–∞ -->
    <div>
      <label for="theme">Theme</label>
      <input
        type="text"
        id="theme"
        name="theme"
        :value="settings.theme"
        required
      />
    </div>
    <!-- –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ -->
    <div>
      <label for="base_font_size">Base font size</label>
      <input
        type="text"
        id="base_font_size"
        name="base_font_size"
        :value="settings.base_font_size"
        required
      />
    </div>

    <button>Save</button>
  </form>
</template>
```

–°–∫—Ä–∏–ø—Ç:

```js
export default {
  // –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  name: 'Settings',
  // –ø—Ä–æ–ø—ã
  props: {
    settings: {
      type: Object,
      required: true
    },
    getSettings: {
      type: Function,
      required: true
    },
    apiUri: {
      type: String,
      required: true
    }
  },
  // –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  data() {
    return {
      loading: false,
      error: null
    }
  },
  // –º–µ—Ç–æ–¥—ã
  methods: {
    // –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ –ë–î
    async saveSettings(e) {
      this.loading = true
      const formDataObj = [...new FormData(e.target)].reduce(
        (obj, [key, val]) => ({
          ...obj,
          [key]: val
        }),
        {}
      )
      try {
        const response = await fetch(`${this.apiUri}/${this.settings.id}`, {
          method: 'PUT',
          body: JSON.stringify(formDataObj),
          headers: {
            'Content-Type': 'application/json'
          }
        })
        if (!response.ok) throw response
        // –ø–æ–ª—É—á–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        await this.getSettings()
      } catch (e) {
        this.error = e
      } finally {
        this.loading = false
      }
    }
  }
}
```

–ù–∞ —ç—Ç–æ–º —Å –∞–¥–º–∏–Ω–∫–æ–π –º—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏.

### –ö–ª–∏–µ–Ω—Ç

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π (`client/src`):

```
- api
  - settings.api.js - API –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
  - todo.api.js - API –¥–ª—è –∑–∞–¥–∞—á
- components
  - TodoForm.js - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
  - TodoList.js - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á
- hooks
  - useStore.js - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –≤–∏–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ö—É–∫–∞
- App.js - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- App.css
- index.js
```

–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [`Zustand`](https://github.com/harryheman/React-Total/blob/main/md/zustand.md).

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –µ–≥–æ:

```bash
yarn add zustand
```

–ù–∞—á–Ω–µ–º —Å API –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ (`api/settings.api.js`):

```js
// –∫–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞
const API_URI = 'http://localhost:5000/api/settings'

// –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
const fetchSettings = async () => {
  try {
    const response = await fetch(API_URI)
    if (!response.ok) throw response
    return await response.json()
  } catch (e) {
    throw e
  }
}

const settingsApi = { fetchSettings }

export default settingsApi
```

API –¥–ª—è –∑–∞–¥–∞—á (`api/todo.api.js`):

```js
// –∫–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞
const API_URI = 'http://localhost:5000/api/todo'

// –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–¥–∞—á
const fetchTodos = async () => {
  try {
    const response = await fetch(API_URI)
    if (!response.ok) throw response
    return await response.json()
  } catch (e) {
    throw e
  }
}

// –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
const addTodo = async (newTodo) => {
  try {
    const response = await fetch(API_URI, {
      method: 'POST',
      body: JSON.stringify(newTodo),
      headers: {
        'Content-Type': 'application/json'
      }
    })
    if (!response.ok) throw response
    return await response.json()
  } catch (e) {
    throw e
  }
}

// –º–µ—Ç–æ–¥ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
const updateTodo = async (id, changes) => {
  try {
    const response = await fetch(`${API_URI}/${id}`, {
      method: 'PUT',
      body: JSON.stringify(changes),
      headers: {
        'Content-Type': 'application/json'
      }
    })
    if (!response.ok) throw response
    return await response.json()
  } catch (e) {
    throw e
  }
}

// –º–µ—Ç–æ–¥ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
const removeTodo = async (id) => {
  try {
    const response = await fetch(`${API_URI}/${id}`, {
      method: 'DELETE'
    })
    if (!response.ok) throw response
  } catch (e) {
    throw e
  }
}

const todoApi = { fetchTodos, addTodo, updateTodo, removeTodo }

export default todoApi
```

–•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –≤–∏–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ö—É–∫–∞ (`hooks/useStore.js`):

```js
import create from 'zustand'
// API –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
import settingsApi from '../api/settings.api'
// API –¥–ª—è –∑–∞–¥–∞—á
import todoApi from '../api/todo.api'

const useStore = create((set, get) => ({
  // –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  settings: {},
  todos: [],
  loading: false,
  error: null,
  // –º–µ—Ç–æ–¥—ã –¥–ª—è
  // –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
  fetchSettings() {
    set({ loading: true })
    settingsApi
      .fetchSettings()
      .then((settings) => {
        set({ settings })
      })
      .catch((error) => {
        set({ error })
      })
      .finally(() => {
        set({ loading: false })
      })
  },
  // –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–¥–∞—á
  fetchTodos() {
    set({ loading: true })
    todoApi
      .fetchTodos()
      .then((todos) => {
        set({ todos })
      })
      .catch((error) => {
        set({ error })
      })
      .finally(() => {
        set({ loading: false })
      })
  },
  // —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
  addTodo(newTodo) {
    set({ loading: true })
    todoApi
      .addTodo(newTodo)
      .then((newTodo) => {
        const todos = [...get().todos, newTodo]
        set({ todos })
      })
      .catch((error) => {
        set({ error })
      })
      .finally(() => {
        set({ loading: false })
      })
  },
  // –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
  updateTodo(id, changes) {
    set({ loading: true })
    todoApi
      .updateTodo(id, changes)
      .then((updatedTodo) => {
        const todos = get().todos.map((todo) =>
          todo.id === updatedTodo.id ? updatedTodo : todo
        )
        set({ todos })
      })
      .catch((error) => {
        set({ error })
      })
      .finally(() => {
        set({ loading: false })
      })
  },
  // —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
  removeTodo(id) {
    set({ loading: true })
    todoApi
      .removeTodo(id)
      .then(() => {
        const todos = get().todos.filter((todo) => todo.id !== id)
        set({ todos })
      })
      .catch((error) => {
        set({ error })
      })
      .finally(() => {
        set({ loading: false })
      })
  }
}))

export default useStore
```

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ (`components/TodoForm.js`):

```js
import { useState, useEffect } from 'react'
import useStore from '../hooks/useStore'

export default function TodoForm() {
  // –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
  const addTodo = useStore(({ addTodo }) => addTodo)
  // —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
  const [text, setText] = useState('')
  const [disable, setDisable] = useState(true)

  useEffect(() => {
    setDisable(!text.trim())
  }, [text])

  // –º–µ—Ç–æ–¥ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∑–∞–¥–∞—á–∏
  const onChange = ({ target: { value } }) => {
    setText(value)
  }

  // –º–µ—Ç–æ–¥ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
  const onSubmit = (e) => {
    e.preventDefault()
    if (disable) return
    const newTodo = {
      text,
      done: false
    }
    addTodo(newTodo)
  }

  return (
    <form onSubmit={onSubmit}>
      <label htmlFor='text'>New todo text</label>
      <input type='text' id='text' value={text} onChange={onChange} />
      <button className='add'>Add</button>
    </form>
  )
}
```

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á (`components/TodoList.js`):

```js
import useStore from '../hooks/useStore'

export default function TodoList() {
  // –∑–∞–¥–∞—á–∏ –∏ –º–µ—Ç–æ–¥—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
  const { todos, updateTodo, removeTodo } = useStore(
    ({ todos, updateTodo, removeTodo }) => ({ todos, updateTodo, removeTodo })
  )

  return (
    <ul>
      {todos.map(({ id, text, done }) => (
        <li key={id}>
          <input
            type='checkbox'
            checked={done}
            onChange={() => {
              updateTodo(id, { done: !done })
            }}
          />
          <span>{text}</span>
          <button
            onClick={() => {
              removeTodo(id)
            }}
          >
            Remove
          </button>
        </li>
      ))}
    </ul>
  )
}
```

–û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (`App.js`):

```js
import { useEffect } from 'react'
import './App.css'
import useStore from './hooks/useStore'
import TodoForm from './components/TodoForm'
import TodoList from './components/TodoList'

// –ø–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
useStore.getState().fetchSettings()
// –ø–æ–ª—É—á–∞–µ–º –∑–∞–¥–∞—á–∏
useStore.getState().fetchTodos()

function App() {
  // –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–∫–∞ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
  const { settings, loading, error } = useStore(
    ({ settings, loading, error }) => ({ settings, loading, error })
  )

  useEffect(() => {
    if (Object.keys(settings).length) {
      // –ø—Ä–∏–º–µ–Ω—è–µ–º –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –∫ —ç–ª–µ–º–µ–Ω—Ç—É `html`
      document.documentElement.style.fontSize = settings.base_font_size
      // –ø—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É
      document.body.className = settings.theme
    }
  }, [settings])

  // –∑–∞–≥—Ä—É–∑–∫–∞
  if (loading) return <h2>Loading...</h2>

  // –æ—à–∏–±–∫–∞
  if (error)
    return (
      <h3 className='error'>
        {error.message || 'Something went wrong. Try again later'}
      </h3>
    )

  return (
    <div className='App'>
      <h1>Client</h1>
      <h2>{settings.greetings}</h2>
      <TodoForm />
      <TodoList />
    </div>
  )
}

export default App
```

–°—Ç–∏–ª–∏ (`App.css`):

```css
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@200;400;600&display=swap');

:root {
  --primary: #0275d8;
  --success: #5cb85c;
  --warning: #f0ad4e;
  --danger: #d9534f;
  --light: #f7f7f7;
  --dark: #292b2c;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Montserrat', sans-serif;
  font-size: 1rem;
}

/* –¢–µ–º–∞ */
body.light {
  background-color: var(--light);
  color: var(--dark);
}

body.dark {
  background-color: var(--dark);
  color: var(--light);
}
/* --- */

#root {
  padding: 1rem;
  display: flex;
  justify-content: center;
}

.App {
  display: flex;
  flex-direction: column;
  align-items: center;
}

h1,
h2 {
  margin: 1rem 0;
}

h1 {
  font-size: 1.6rem;
}

h2 {
  font-size: 1.4rem;
}

h3 {
  font-size: 1.2rem;
}

label {
  margin-bottom: 0.5rem;
  display: block;
}

form {
  margin: 1rem 0;
}

form input {
  padding: 0.5rem;
  max-width: 220px;
  width: max-content;
  outline: none;
  border: 1px solid var(--dark);
  border-radius: 4px;
  text-align: center;
}

form input:focus {
  border-color: var(--primary);
}

ul {
  list-style: none;
}

li {
  margin: 0.75rem 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

li input {
  width: 18px;
  height: 18px;
}

li span {
  display: block;
  width: 120px;
  word-break: break-all;
}

button {
  padding: 0.5rem 1rem;
  background: none;
  border: none;
  border-radius: 4px;
  outline: none;
  background-color: var(--danger);
  color: var(--light);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
  cursor: pointer;
  user-select: none;
  transition: 0.2s;
}

button:active {
  box-shadow: none;
}

button.add {
  background-color: var(--success);
}

.error {
  color: var(--danger);
}

.App {
  text-align: center;
}
```

–ü–æ—Å–∫–æ–ª—å–∫—É –æ—Ç—Å—Ç—É–ø—ã –∏ —Ä–∞–∑–º–µ—Ä—ã –∑–∞–¥–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é [rem](https://webref.ru/css/unit/rem), –º—ã –ª–µ–≥–∫–æ –º–æ–∂–µ–º –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –º–µ–Ω—è—è —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ `html`.

–ù–∞ —ç—Ç–æ–º —Å –∫–ª–∏–µ–Ω—Ç–æ–º –º—ã —Ç–∞–∫–∂–µ –∑–∞–∫–æ–Ω—á–∏–ª–∏.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü–æ–¥–Ω–∏–º–∞–µ–º—Å—è –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (`docker-test`), –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º `Node.js-–ø—Ä–æ–µ–∫—Ç` –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º [`concurrently`](https://www.npmjs.com/package/concurrently) - —É—Ç–∏–ª–∏—Ç—É –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª–µ `package.json`:

```bash
# –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `docker-test`
yarn init -yp
yarn add concurrently
```

–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤ `package.json`:

```json
"scripts": {
  "dev:client": "yarn --cwd services/client start",
  "dev:admin": "yarn --cwd services/admin dev",
  "dev:api": "yarn --cwd services/api dev",
  "dev": "concurrently \"yarn dev:client\" \"yarn dev:admin\" \"yarn dev:api\""
}
```

–í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É `yarn dev` –∏–ª–∏ `npm run dev`.

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∑–∞–ø—É—Å–∫—É 3 —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

- –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:3000`:

<img src="https://habrastorage.org/webt/ve/jd/5q/vejd5qrgzgbzll2pyb0jxpg0ucw.png" alt="" />
<br />

- –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:4000`":

<img src="https://habrastorage.org/webt/tz/uy/7-/tzuy7-muwq_lxdant4hgpnfemjs.png" alt="" />
<br />

- –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:5000`.

–ú–µ–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∞–¥–º–∏–Ω–∫–µ:

<img src="https://habrastorage.org/webt/kp/63/wu/kp63wu9r_cdnd-cyqwc9-p2dle0.png" alt="" />
<br />

–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞:

<img src="https://habrastorage.org/webt/85/fy/cw/85fycwhapup8y_auvgrldgwke1m.png" alt="" />
<br />

–í–∏–¥–∏–º, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å.

–†–∞–±–æ—Ç–∞–µ–º —Å –∑–∞–¥–∞—á–∞–º–∏:

<img src="https://habrastorage.org/webt/sw/yr/nc/swyrncbic8rxv1s0rxeczhg1bhk.png" alt="" />
<br />

–ó–∞–¥–∞—á–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞—é—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è/—É–¥–∞–ª—è—é—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î.

–û—Ç–ª–∏—á–Ω–æ. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è.

[–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –∫–æ–¥–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](https://github.com/harryheman/docker-test).

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ [npm](https://www.npmjs.com/), –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤ —Ñ–∞–π–ª–µ `package.json` –¥–æ–ª–∂–Ω—ã –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

```json
"scripts": {
  "dev:client": "npm run start --prefix services/client",
  "dev:admin": "npm run dev --prefix services/admin",
  "dev:api": "npm run dev --prefix services/api",
  "dev": "concurrently \"npm run dev:client\" \"npm run dev:admin\" \"npm run dev:api\""
}
```

## "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è" –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### Dockerfile

–ù–∞—á–Ω–µ–º —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `Dockerfile` –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `client` —Å–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª `Dockerfile`  —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è:

```dockerfile
# –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è `Node.js`
ARG NODE_VERSION=16.13.1

# –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –æ–±—Ä–∞–∑
FROM node:$NODE_VERSION

# —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
WORKDIR /client

# –∫–æ–ø–∏—Ä—É–µ–º —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
COPY package.json yarn.lock ./

# —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN yarn

# –∫–æ–ø–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
COPY . .

# –≤—ã–ø–æ–ª–Ω—è–µ–º —Å–±–æ—Ä–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
RUN yarn build
```

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: –Ω–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –≤–º–µ—Å—Ç–æ —Å–±–æ—Ä–∫–∏ (`RUN yarn build`) –º—ã –º–æ–≥–ª–∏ –±—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—É `start` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: `CMD ["yarn", "start"]`, –Ω–æ –µ—Å–ª–∏ –º—ã —Ç–∞–∫ —Å–¥–µ–ª–∞–µ–º, —Ç–æ –≤–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ –Ω–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π `Dockerfile` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞. –ü—Ä–æ—â–µ —Å—Ä–∞–∑—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é `Dockerfile`, –∞ –∫–æ–º–∞–Ω–¥—É `start` –∑–∞–ø—É—Å–∫–∞—Ç—å –∏–∑ `docker-compose.yml`.

–°–æ–∑–¥–∞–µ–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–π `Dockerfile` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `admin`:

```dockerfile
ARG NODE_VERSION=16.13.1

FROM node:$NODE_VERSION as build

WORKDIR /admin

COPY package.json yarn.lock ./

RUN yarn

COPY . .

RUN yarn build
```

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: —Å–±–æ—Ä–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `client/build`, –∞ —Å–±–æ—Ä–∫–∞ –∞–¥–º–∏–Ω–∫–∏ - –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `admin/dist`. –í —Ñ–∞–π–ª–µ `api/index.js` –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ç–∞–∫–∏–µ —Å—Ç—Ä–æ–∫–∏:

```js
if (process.env.ENV === 'production') {
  const clientBuildPath = join(__dirname, 'client', 'build')
  const adminDistPath = join(__dirname, 'admin', 'dist')

  app.use(express.static(clientBuildPath))
  app.use(express.static(adminDistPath))
  app.use('/admin', (req, res) => {
    res.sendFile(join(adminDistPath, decodeURIComponent(req.url)))
  })
}
```

–≠—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –≥–æ–≤–æ—Ä—è—Ç –Ω–∞–º –æ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ (`process.env.ENV === 'production'`), –æ–Ω –±—É–¥–µ—Ç –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∏–∑ –Ω–∞–∑–≤–∞–Ω–Ω—ã—Ö –≤—ã—à–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π: –∫–ª–∏–µ–Ω—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –º–∞—Ä—à—Ä—É—Ç—É (—Ä–æ—É—Ç—É) `/`, –∞ –∞–¥–º–∏–Ω–∫–∞ - –ø–æ —Ä–æ—É—Ç—É `/admin`. –ú—ã –≤–µ—Ä–Ω–µ–º—Å—è –∫ —ç—Ç–æ–º—É –ø–æ–∑–∂–µ.

–°–æ–∑–¥–∞–µ–º –ø–æ—Ö–æ–∂–∏–π `Dockerfile` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `api`:

```dockerfile
ARG NODE_VERSION=16.13.1

FROM node:$NODE_VERSION

WORKDIR /app

COPY package.json yarn.lock ./

RUN yarn

COPY . .

# –≤—ã—Å—Ç–∞–≤–ª—è–µ–º –ø–æ—Ä—Ç
EXPOSE 5000

# –∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ
CMD ["yarn", "start"]
```

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `EXPOSE 5000` –∏ `CMD ["yarn", "start"]` –Ω–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –º–æ–∂–Ω–æ –æ–ø—É—Å—Ç–∏—Ç—å, –Ω–æ –æ–Ω–∏ –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è –Ω–∞–º –≤ –ø—Ä–æ–¥–∞–∫—à–Ω–µ. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–µ-—á—Ç–æ –µ—â–µ, –Ω–æ –ø–æ–∑–≤–æ–ª—å—Ç–µ –ø–æ–∫–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ç—Ä–∏–≥—É.

–¢–∞–∫–∂–µ _–æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_, —á—Ç–æ —è –≤–Ω–µ—Å –ø–∞—Ä–æ—á–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø—Ä–æ–µ–∫—Ç:

1. –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `.env`, –Ω–∞—Ö–æ–¥—è—â–µ–≥–æ—Å—è –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# –¥–æ–±–∞–≤–∏–ª –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
APP_NAME=my-app

# —É—Ç–æ—á–Ω–∏–ª –≤–µ—Ä—Å–∏—é `Node.js`
NODE_VERSION=16.13.1

POSTGRES_VERSION=14
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=mydb

# –ø–µ—Ä–µ–Ω–µ—Å —Å—é–¥–∞ –ø—É—Ç—å –∫ –ë–î –∏–∑ —Ñ–∞–π–ª–∞ `api/.env`
# –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤–º–µ—Å—Ç–æ `localhost` –ø–æ—Å–ª–µ —Å–∏–º–≤–æ–ª–∞ `@` –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ - `postgres`
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/mydb?schema=public

ENV=development
```

2. –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Ñ–∞–π–ª `api/package.json`, —Ä–∞–∑–¥–µ–ª `scripts`):

```json
"dev": "prisma migrate dev && prisma db seed && nodemon",
```

–•–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π —Å—á–∏—Ç–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ –æ–±—Ä–∞–∑–∞ —Å –ø–æ–º–æ—â—å—é `.dockerignore`:

```bash
node_modules
yarn-error.log
# mac
.DS_Store
```

–¢–∞–∫–æ–π —Ñ–∞–π–ª –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–∏—Å–µ.

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è `Dockerfile` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –º—ã –≥–æ—Ç–æ–≤—ã –∫ "–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏" –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### Docker Compose

–°–æ–∑–¥–∞–µ–º –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Ñ–∞–π–ª `docker-compose.dev.yml` —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è:

```yml
# –≤–µ—Ä—Å–∏—è `compose`
version: '3.9'
# —Å–µ—Ä–≤–∏—Å—ã
services:
  # –ë–î
  postgres:
    # —Ñ–∞–π–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è
    env_file: .env
    # –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    container_name: ${APP_NAME}_postgres
    # –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –æ–±—Ä–∞–∑
    image: postgres:${POSTGRES_VERSION}
    # –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    volumes:
      - data_postgres:/var/lib/postgresql/data
    # –ø–æ—Ä—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î
    ports:
      - 5432:5432
    # –ø–æ–ª–∏—Ç–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    restart: on-failure

  client:
    env_file: .env
    container_name: ${APP_NAME}_client
    image: node:${NODE_VERSION}
    # —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
    working_dir: /app
    # –∞–Ω–æ–Ω–∏–º–Ω—ã–π —Ç–æ–º
    # `rw` –æ–∑–Ω–∞—á–∞–µ—Ç `read/write` - —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å
    volumes:
      - ./services/client:/app:rw
    # —Å–µ—Ä–≤–∏—Å, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–∞–≤–∏—Å–∏—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
    depends_on:
      - api
    ports:
      - 3000:3000
    restart: on-failure
    # –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
    command: bash -c "yarn start"

  admin:
    env_file: .env
    container_name: ${APP_NAME}_admin
    image: node:${NODE_VERSION}
    working_dir: /app
    volumes:
      - ./services/admin:/app:rw
    depends_on:
      - api
    ports:
      - 4000:4000
    restart: on-failure
    command: bash -c "yarn dev"

  api:
    env_file: .env
    container_name: ${APP_NAME}_api
    # —Å—Å—ã–ª–∫–∞ –Ω–∞ `Dockerfile`, –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–±–æ—Ä–∫–∞
    build: services/api
    ports:
      - 5000:5000
    depends_on:
      - postgres
    restart: on-failure
    # –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å –∫–æ–º–∞–Ω–¥—ã `yarn start`, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –≤ `Dockerfile`
    command: bash -c "yarn dev"

# —Ç–æ–º–∞
volumes:
  data_postgres:
```

–û–ø—Ä–µ–¥–µ–ª–∏–º –≤ `package.json` –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è `compose`:

```json
"dev:compose:up": "docker compose -f docker-compose.dev.yml up -d",
"dev:compose:stop": "docker compose -f docker-compose.dev.yml stop",
"dev:compose:rm": "docker compose -f docker-compose.dev.yml rm",
"compose:up": "docker compose up -d",
"compose:stop": "docker compose stop",
"compose:rm": "docker compose rm"
```

–ö–æ–º–∞–Ω–¥–∞ `compose:up` –ø–æ–¥–Ω–∏–º–∞–µ—Ç, –∫–æ–º–∞–Ω–¥–∞ `compose:stop` - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç, –∞ –∫–æ–º–∞–Ω–¥–∞ `compose:rm` - —É–¥–∞–ª—è–µ—Ç —Å–µ—Ä–≤–∏—Å. –ü—Ä–µ—Ñ–∏–∫—Å `dev:` –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è/–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è/—É–¥–∞–ª—è–µ—Ç—Å—è —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –í —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞ –æ–∑–Ω–∞—á–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–º —Å–µ—Ä–≤–∏—Å–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `compose` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª `docker-compose.yml`, –∫–æ—Ç–æ—Ä—ã–º –º—ã –∑–∞–π–º–µ–º—Å—è –ø–æ–∑–∂–µ).

–ï—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å `compose` –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
# —Å–ø–∏—Å–æ–∫ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps

# —Å–ø–∏—Å–æ–∫ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose ls

# —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–∑–æ–≤
docker images

# —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞
# [image-name] - –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞
docker image rm [image-name]
# –Ω–∞–ø—Ä–∏–º–µ—Ä
docker image rm docker-test_api

# —Å–ø–∏—Å–æ–∫ —Ç–æ–º–æ–≤
docker volume ls

# —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–º–∞
# [volume-name] - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–º–∞
docker volume rm [volume-name]
# –Ω–∞–ø—Ä–∏–º–µ—Ä
docker volume rm postgres_data

# –æ—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã (—Ç–æ–º–∞ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è)
docker system prune -a
```

–ü–æ–¥–Ω–∏–º–∞–µ–º —Å–µ—Ä–≤–∏—Å –≤ —Ä–µ–∂–∏–º–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `yarn dev:compose:up` –∏–ª–∏ `npm run dev:compose:up`:

<img src="https://habrastorage.org/webt/8v/nn/wd/8vnnwdtoonf8r4shpr79a7zp7iu.png" alt="" />
<br />
<img src="https://habrastorage.org/webt/nk/le/j2/nklej2vgp4nc9q-bhy5nbhesjli.png" alt="" />
<br />

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å–µ—Ä–≤–∏—Å–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–∞–∫–æ–µ-—Ç–æ –≤—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫, –ø–æ—Å–ª–µ —á–µ–≥–æ –æ–Ω–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∞–¥—Ä–µ—Å–∞–º:

- –∫–ª–∏–µ–Ω—Ç: `localhost:3000`;
- –∞–¥–º–∏–Ω–∫–∞: `localhost:4000`;
- —Å–µ—Ä–≤–µ—Ä: `localhost:5000` (–Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞; –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –∏ –∞–¥–º–∏–Ω–∫–∏);
- –ë–î: `postgres:5432` (–Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞; –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞).

–ü–æ —Å—É—Ç–∏, –∫–æ–º–∞–Ω–¥–∞ `dev:compose:up` –¥–µ–ª–∞–µ—Ç —Ç–æ–∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ –∫–æ–º–∞–Ω–¥–∞ `dev` + —Å–∫—Ä–∏–ø—Ç –∏–∑ —Ñ–∞–π–ª–∞ `db`.

–ß–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏? –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –≤—Å—é —Å—Ç–∞—Ç–∏–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–ª —Å–µ—Ä–≤–µ—Ä, –ø–æ—ç—Ç–æ–º—É –Ω–∞–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–∞–∫–æ–π-—Ç–æ —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–∞—Ç—å `api` —Å–±–æ—Ä–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏ –∞–¥–º–∏–Ω–∫–∏. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å. –û–¥–Ω–∏–º –∏–∑ —Å–∞–º—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö –∏ —É–¥–æ–±–Ω—ã—Ö —è–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ [Docker Hub](https://hub.docker.com/).

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ —Å—Å—ã–ª–∫–µ –∏ —Å–æ–∑–¥–∞–µ–º –∞–∫–∫–∞—É–Ω—Ç.

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `client` –∏ —Å–æ–∑–¥–∞–µ–º –æ–±—Ä–∞–∑ —Å —Ç–µ–≥–æ–º:

```bash
cd client
# [username] - –≤–∞—à –ª–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞ –≤ dockerhub
# —Ç–µ–≥ –æ–±—Ä–∞–∑–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å –≤–∞—à–µ–≥–æ –ª–æ–≥–∏–Ω–∞
docker build . -t [username]/docker-test_client
# –º–æ–π –ª–æ–≥–∏–Ω - aio350
docker build . -t aio350/docker-test_client
```

–ê–≤—Ç–æ—Ä–∏–∑—É–µ–º—Å—è –≤ `dockerhub` –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ–±—Ä–∞–∑ –≤ —Å–≤–æ–π —Ä–µ–µ—Å—Ç—Ä:

```bash
docker login

docker push aio350/docker-test_client
```

–î–µ–ª–∞–µ–º —Ç–æ–∂–µ —Å–∞–º–æ–µ –¥–ª—è –∞–¥–º–∏–Ω–∫–∏:

```bash
cd admin

docker build . -t aio350/docker-test_admin

docker push aio350/docker-test_admin
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤ —Å–≤–æ–µ–º —Ä–µ–µ—Å—Ç—Ä–µ `dockerhub` –º—ã —É–≤–∏–¥–∏–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç–∏–Ω—É:

<img src="https://habrastorage.org/webt/nk/8k/qw/nk8kqwzyg2atkg7znuf9maep9pe.png" alt="" />
<br />

–ù–µ–º–Ω–æ–≥–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ñ–∞–π–ª `api/Dockerfile`:

```dockerfile
ARG NODE_VERSION=16.13.1

# –∫–æ–ø–∏—Ä—É–µ–º –æ–±—Ä–∞–∑ –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ `dockerhub`
# `AS` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ —ç—Ç–æ—Ç —Å–ª–æ–π –≤ –¥—Ä—É–≥–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö
FROM aio350/docker-test_client AS client
# –æ–±—Ä–∞–∑ –∞–¥–º–∏–Ω–∫–∏
FROM aio350/docker-test_admin AS admin

FROM node:$NODE_VERSION

WORKDIR /app

COPY package.json yarn.lock ./

RUN yarn

COPY . .

# –∫–æ–ø–∏—Ä—É–µ–º —Å–±–æ—Ä–∫—É –∫–ª–∏–µ–Ω—Ç–∞
COPY --from=client /client/build /app/client/build
# –∫–æ–ø–∏—Ä—É–µ–º —Å–±–æ—Ä–∫—É –∞–¥–º–∏–Ω–∫–∏
COPY --from=admin /admin/dist /app/admin/dist

EXPOSE 5000

CMD ["yarn", "start"]
```

–°–æ–∑–¥–∞–µ–º –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ —Ñ–∞–π–ª `docker-compose.yml` —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è:

```yml
version: '3.9'
services:
  postgres:
    env_file: .env
    container_name: ${APP_NAME}_postgres
    image: postgres:${POSTGRES_VERSION}
    volumes:
      - data_postgres:/var/lib/postgresql/data
    ports:
      - 5432:5432
    restart: on-failure
  # —Å—Ç–∞—Ç–∏–∫–∞ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º
  # –ø–æ—ç—Ç–æ–º—É –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –ø–æ–¥–Ω–∏–º–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã `client` –∏ `admin`
  api:
    env_file: .env
    # –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `ENV`, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –≤ —Ñ–∞–π–ª–µ `.env`
    environment:
      - ENV=production
    container_name: ${APP_NAME}_api
    build: services/api
    depends_on:
      - postgres
    ports:
      - 5000:5000
    restart: on-failure
    # –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `yarn start`, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –≤ `Dockerfile`

volumes:
  data_postgres:
```

–£–¥–∞–ª—è–µ–º —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —É–¥–∞–ª—è–µ–º –æ–±—Ä–∞–∑ `docker-test_api`, —É–¥–∞–ª—è–µ–º —Ç–æ–º `docker-test_data_postgres` –∏ –ø–æ–¥–Ω–∏–º–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å:

```bash
yarn dev:compose:stop
yarn dev:compose:rm

# –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
docker image rm docker-test_api

docker volume rm docker-test_data_postgres

yarn compose:up
```

<img src="https://habrastorage.org/webt/kb/cb/bu/kbcbbu9_p16qtrzv6ejbvlg7jpy.png" alt="" />
<br />

–¢–µ–ø–µ—Ä—å –Ω–∞—à —Å–µ—Ä–≤–∏—Å —Å–æ—Å—Ç–æ–∏—Ç –≤—Å–µ–≥–æ –∏–∑ 2 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

–ö–ª–∏–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `localhost:5000`, –∞ –∞–¥–º–∏–Ω–∫–∞ - –ø–æ –∞–¥—Ä–µ—Å—É `localhost:5000/admin`.

<img src="https://habrastorage.org/webt/v4/_1/71/v4_171hi0yhfqv-jhmhbyjbhqo8.png" alt="" />
<br />
<img src="https://habrastorage.org/webt/2r/jy/bh/2rjybhdepx7ozyifsuvdyi9-udk.png" alt="" />
<br />

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è.

–ù–∞ —ç—Ç–æ–º "–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—é" –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π.
